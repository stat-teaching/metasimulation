<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/quarto-contrib/jquery-3.6.3/jquery-3.6.3.min.js"></script>
<script src="../../site_libs/quarto-contrib/code-fullscreen-1.0.0/code-fullscreen.js" defer="true"></script>
<link href="../../site_libs/quarto-contrib/code-fullscreen-1.0.0/code-fullscreen.css" rel="stylesheet">
<script src="../../site_libs/quarto-contrib/nutshell-1.0.0/nutshell.min.js"></script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<meta charset="utf-8">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" rel="stylesheet">
<meta name="generator" content="quarto-1.4.527">
<meta name="author" content="Filippo Gambarota">
<meta name="author" content="Gianmarco Altoè">
<meta name="dcterms.date" content="2024-02-08">
<title>Meta-analysis Workshop - Meta-regression</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
<link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
<link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto.css">
<link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
<link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
<link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
<link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
<style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
<style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="center"><h1 class="title">Meta-regression</h1>
  <p class="author">Filippo Gambarota</p>
  <p class="author">Gianmarco Altoè</p>
  <p class="institute">Department of Developmental Psychology and Socialization, University of Padova</p>
  <p class="date">08 February 2024</p>
</section><section><section id="meta-analysis-as-weighted-linear-regression" class="title-slide slide level1 section center"><h1>Meta-analysis as (weighted) linear regression</h1>

</section><section id="ma-as-weighted-linear-regression" class="slide level2"><h2>MA as (weighted) linear regression</h2>
<p>Both the EE and RE model can be seen as standard (weighted) linear regression models. Precisely, there is a difference in fitting a meta-analysis using <code>lm</code> or <code><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lme4::lmer()</a></code> and <code>rma</code> (see <a href="https://www.metafor-project.org/doku.php/tips:rma_vs_lm_lme_lmer">https://www.metafor-project.org/doku.php/tips:rma_vs_lm_lme_lmer</a>).</p>
<div class="fragment">
<p>Beyond these differences a general the EE and RE models are intercept-only linear regressions.</p>
<p><span class="math display">\[
\boldsymbol{Y} = \mathbf{X}\boldsymbol{\beta} + \boldsymbol{\epsilon}
\]</span></p>
<p>The EE model:</p>
<p><span class="math display">\[
y_i = \beta_0 + \epsilon_i
\]</span></p>
<p>The RE model:</p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_{0_i} + \epsilon_i
\]</span></p>
</div>
</section><section id="ma-as-weighted-linear-regression-1" class="slide level2"><h2>MA as (weighted) linear regression</h2>
<p>In the EE model <span class="math inline">\(\beta_0\)</span> is <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\epsilon_i \sim \mathcal{N}(0, \sigma^2_i)\)</span></p>
<p><span class="math display">\[
y_i = \beta_0 + \epsilon_i
\]</span></p>
<p>In the RE model <span class="math inline">\(\beta_0\)</span> is <span class="math inline">\(\mu_{\theta}\)</span> and <span class="math inline">\(\beta_{0_i}\)</span> are the <span class="math inline">\(\delta_i\)</span>.</p>
</section><section id="explaining-tau2" class="slide level2"><h2>Explaining <span class="math inline">\(\tau^2\)</span>
</h2>
<p>So far we simply assumed <span class="math inline">\(\tau^2 = 0\)</span> (for the EE model) or estimated it using the RE model.</p>
<div class="fragment">
<p>We can extend the intercept-only meta-analysis by including study-level predictors (as in standard linear regression) to explain the estimated true heterogeneity.</p>
</div>
</section><section id="explaining-tau2-1" class="slide level2"><h2>Explaining <span class="math inline">\(\tau^2\)</span>
</h2>
<p>Let’s make an example where we simulate a meta-analysis with <span class="math inline">\(k = 100\)</span> studies. Beyond the effect size, we extracted an experimental condition where 50 studies where lab-based experiments <span class="math inline">\(x_{lab}\)</span> and 50 studies where online experiments.</p>
<p>We assume that there could be a <strong>lab effect</strong> thus we included a predictor in the model.</p>
</section><section id="explaining-tau2-2" class="slide level2"><h2>Explaining <span class="math inline">\(\tau^2\)</span>
</h2>
<p>Now the model have a predictor <span class="math inline">\(x\)</span> (the type of experiment) and two parameters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>. Depending on the contrast coding (default to <code><a href="https://rdrr.io/r/stats/contrast.html">contr.treatment()</a></code> in R) the <span class="math inline">\(\beta_0\)</span> is different. Coding <code>exp</code> as 0 for lab-based experiments and 1 for online experiments:</p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1X_{1_i} + \epsilon_i
\]</span></p>
<p><span class="math display">\[
y_{\text{lab}_i} = \beta_0 + \epsilon_i
\]</span></p>
<p><span class="math display">\[
y_{\text{online}_i} = \beta_0 + \beta_1 + \epsilon_i
\]</span></p>
</section><section id="explaining-tau2-3" class="slide level2"><h2>Explaining <span class="math inline">\(\tau^2\)</span>
</h2>
<p>What is missing is the random-effect. Basically we still have <span class="math inline">\(\tau^2\)</span> determining the <span class="math inline">\(\delta_i \sim \mathcal{N}(0, \tau^2)\)</span> but now is the residual <span class="math inline">\(\tau^2_r\)</span>. The heterogeneity after including the predictor.</p>
<p><span id="eq-metareg-cat"><span class="math display">\[
y_i = \beta_0 + \beta_{0_i} + \beta_1X_{1_i} + \epsilon_i
\tag{1}\]</span></span></p>
<p><span class="math display">\[
\beta_{0_i} \sim \mathcal{N}(0, \tau^2_r)
\]</span></p>
<p>Clearly the difference between <span class="math inline">\(\tau^2\)</span> (the total heterogeneity) and <span class="math inline">\(\tau^2_r\)</span> (residual heterogeneity) is an index of the impact of <span class="math inline">\(X\)</span>.</p>
</section><section id="simulating-the-x-effect" class="slide level2"><h2>Simulating the <span class="math inline">\(X\)</span> effect</h2>
<p>To simulate a meta-regression we just need to choose the parameters values (<span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>) and implement <a href="#/explaining-tau2-3" class="quarto-xref">Equation&nbsp;1</a>. Using treatment coding, <span class="math inline">\(\beta_0\)</span> is the effect size when <span class="math inline">\(X = 0\)</span> (i.e., lab-based experiments) and <span class="math inline">\(\beta_1\)</span> is the difference between lab and online experiments.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>       exp exp_dummy  es
1      lab         0 0.3
2      lab         0 0.3
3      lab         0 0.3
4      lab         0 0.3
5      lab         0 0.3
95  online         1 0.8
96  online         1 0.8
97  online         1 0.8
98  online         1 0.8
99  online         1 0.8
100 online         1 0.8</code></pre>
</div>
</div>
</section><section id="simulating-the-x-effects" class="slide level2"><h2>Simulating the <span class="math inline">\(X\)</span> effects</h2>
<p>Now we can use the <code>sim_studies()</code> function as usual. The difference is that <code>es</code> is no longer a single value but a vector (with different values according to the <span class="math inline">\(X\)</span> level) and <code>tau2</code> is <span class="math inline">\(\tau^2_r\)</span> (this the leftover heterogeneity after including the <span class="math inline">\(X\)</span> effect)</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
     id     yi     vi n1 n2    exp 
1     1 0.4847 0.0570 44 44    lab 
2     2 0.7244 0.0739 33 33    lab 
3     3 0.5974 0.0650 42 42    lab 
4     4 0.4499 0.0422 43 43    lab 
5     5 0.6217 0.0663 44 44    lab 
95   95 0.6637 0.0376 51 51 online 
96   96 0.9044 0.0579 39 39 online 
97   97 1.3943 0.0698 29 29 online 
98   98 0.7746 0.0360 44 44 online 
99   99 0.7996 0.0837 32 32 online 
100 100 0.7638 0.0448 39 39 online </code></pre>
</div>
</div>
</section><section id="fitting-a-meta-regression-model" class="slide level2"><h2>Fitting a meta-regression Model</h2>
<p>To fit a meta-regression we still use the <code><a href="https://wviechtb.github.io/metafor/reference/rma.uni.html">metafor::rma()</a></code> function, adding the <code>mods = ~</code> parameter with the model formula (same as the right-hand side of a <code>y ~ x</code> call in <code>lm</code>). The name of the predictor in the formula need to match a column of the <code>data =</code> dataframe.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Mixed-Effects Model (k = 100; tau^2 estimator: REML)

  logLik  deviance       AIC       BIC      AICc   
-30.0314   60.0629   66.0629   73.8178   66.3182   

tau^2 (estimated amount of residual heterogeneity):     0.0559 (SE = 0.0152)
tau (square root of estimated tau^2 value):             0.2365
I^2 (residual heterogeneity / unaccounted variability): 52.95%
H^2 (unaccounted variability / sampling variability):   2.13
R^2 (amount of heterogeneity accounted for):            50.53%

Test for Residual Heterogeneity:
QE(df = 98) = 207.6566, p-val &lt; .0001

Test of Moderators (coefficient 2):
QM(df = 1) = 53.1020, p-val &lt; .0001

Model Results:

           estimate      se    zval    pval   ci.lb   ci.ub      
intrcpt      0.3503  0.0458  7.6404  &lt;.0001  0.2604  0.4402  *** 
exponline    0.4767  0.0654  7.2871  &lt;.0001  0.3485  0.6049  *** 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section><section id="intepreting-a-meta-regression-model" class="slide level2"><h2>Intepreting a meta-regression Model</h2>
<p>The output is similar to the RE model with few additions:</p>
<ul>
<li>Everything related to the heterogeneity (<span class="math inline">\(H^2\)</span>, <span class="math inline">\(I^2\)</span>, <span class="math inline">\(Q\)</span>, etc.) is now about <strong>residual heterogeneity</strong>
</li>
<li>There is the (pseudo) <span class="math inline">\(R^2\)</span>
</li>
<li>There is an overall test for the moderators <span class="math inline">\(Q_M\)</span>
</li>
<li>There is a section (similar to standard regression models) with the estimated parameters, standard error and Wald test</li>
</ul></section><section id="model-parameters" class="slide level2"><h2>Model parameters</h2>
<p><code>intrcpt</code> and <code>exponline</code> are the estimates of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>. The interpretation depends on the scale of the effect size and the contrast coding.</p>
<p>We can plot the model results using the <code><a href="https://wviechtb.github.io/metafor/reference/regplot.html">metafor::regplot()</a></code><sup>1</sup>.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure><p><img data-src="meta-regression_files/figure-revealjs/unnamed-chunk-7-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn1"><p>The functions is made for numerical variables thus is less appropriate for categorical variables</p></li></ol></aside></section><section id="omnibus-moderator-test" class="slide level2"><h2>Omnibus Moderator Test</h2>
<p>The <code>Test of Moderators</code> section report the so-called omnibus test for model coeffiecients. Is a simultaneous test for 1 or more coefficients where <span class="math inline">\(H_0: \beta_j = 0\)</span>.</p>
<p>In this case, <strong>coefficient 2</strong> means that we are testing only the 2nd coefficient <span class="math inline">\(\beta_1\)</span>. By default, the intercept is ignored. In fact, the <code>exponline</code> line and the omnibus test are the same (the <span class="math inline">\(\chi^2\)</span> is just the <span class="math inline">\(z^2\)</span>)</p>
<div class="cell">
<pre><code>## Test of Moderators (coefficient 2):
## QM(df = 1) = 53.1020, p-val &lt; .0001
##            estimate      se    zval    pval   ci.lb   ci.ub      
## intrcpt      0.3503  0.0458  7.6404  &lt;.0001  0.2604  0.4402  *** 
## exponline    0.4767  0.0654  7.2871  &lt;.0001  0.3485  0.6049  ***</code></pre>
</div>
</section><section id="general-linear-hypotheses-testing-glht" class="slide level2"><h2>General Linear Hypotheses Testing (GLHT)</h2>
<p>We can also test any combination of parameters. For example we could test if lab-based experiments and online experiments are both different from 0. This is the same as fitting a model without the intercept<sup>1</sup> thus estimating the cell means <span class="citation" data-cites="Schad2020-ht">(see <a href="#/references" role="doc-biblioref" onclick="">Schad et al. 2020</a>)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># now we are testing two coefficients</span></span>
<span><span class="va">fit_no_int</span> <span class="op">&lt;-</span> <span class="fu">rma</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, mods <span class="op">=</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">exp</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span><span class="va">fit_no_int</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Mixed-Effects Model (k = 100; tau^2 estimator: REML)

tau^2 (estimated amount of residual heterogeneity):     0.0559 (SE = 0.0152)
tau (square root of estimated tau^2 value):             0.2365
I^2 (residual heterogeneity / unaccounted variability): 52.95%
H^2 (unaccounted variability / sampling variability):   2.13

Test for Residual Heterogeneity:
QE(df = 98) = 207.6566, p-val &lt; .0001

Test of Moderators (coefficients 1:2):
QM(df = 2) = 372.5111, p-val &lt; .0001

Model Results:

           estimate      se     zval    pval   ci.lb   ci.ub      
explab       0.3503  0.0458   7.6404  &lt;.0001  0.2604  0.4402  *** 
exponline    0.8270  0.0467  17.7238  &lt;.0001  0.7355  0.9184  *** 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn2"><p>see <a href="https://www.metafor-project.org/doku.php/tips:models_with_or_without_intercept">https://www.metafor-project.org/doku.php/tips:models_with_or_without_intercept</a> on removing the intercept</p></li></ol></aside></section><section id="general-linear-hypotheses-testing-glht-1" class="slide level2"><h2>General Linear Hypotheses Testing (GLHT)</h2>
<p>A more elegant way is by using the GLHT framework. Basically we provide a contrast matrix expressing linear combinations of model parameters to be tested. In our case <span class="math inline">\(\text{lab} = \beta_0 = 0\)</span> and <span class="math inline">\(\text{online} = \beta_0 + \beta_1 = 0\)</span>.</p>
<p>Practically, the matrix formulation is the following:</p>
<p><span class="math display">\[
\begin{pmatrix}  
1 &amp; 0 \\
1 &amp; 1
\end{pmatrix}
\begin{pmatrix}  
\beta_0\\
\beta_1
\end{pmatrix}
=
\begin{pmatrix}  
0\\
0
\end{pmatrix}
\]</span></p>
<p>In R:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="va">C</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">B</span> <span class="co"># same as coef(fit)[1] and coef(fit)[1] +  coef(fit)[2]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]
[1,] 0.3503016
[2,] 0.8269936</code></pre>
</div>
</div>
</section><section id="general-linear-hypotheses-testing-glht-2" class="slide level2"><h2>General Linear Hypotheses Testing (GLHT)</h2>
<p>We can use the <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> function providing the model and the hypothesis matrix.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="co"># the default</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Test of Moderators (coefficient 2):
QM(df = 1) = 53.1020, p-val &lt; .0001</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">fit</span>, X <span class="op">=</span> <span class="va">C</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Hypotheses:                           
1:             intrcpt = 0 
2: intrcpt + exponline = 0 

Results:
   estimate     se    zval   pval 
1:   0.3503 0.0458  7.6404 &lt;.0001 
2:   0.8270 0.0467 17.7238 &lt;.0001 

Omnibus Test of Hypotheses:
QM(df = 2) = 372.5111, p-val &lt; .0001</code></pre>
</div>
</div>
<p>Notice that is the same as the model without the intercept.</p>
</section><section id="likelihood-ratio-test-lrt" class="slide level2"><h2>Likelihood Ratio Test (LRT)</h2>
<p>As in standard regression modelling, we can also compare models using LRT. The <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> function will compute the LRT when two (nested) models are provided. In this case we compared a null (intercept-only) model with the model including the predictor.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># the null model</span></span>
<span><span class="va">fit0</span> <span class="op">&lt;-</span> <span class="fu">rma</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data <span class="op">=</span> <span class="va">dat</span>, method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">fit0</span>, <span class="va">fit</span>, refit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># refit = TRUE because LRT with REML is not meaningful, using ML instead</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
        df      AIC      BIC     AICc   logLik     LRT   pval       QE  tau^2 
Full     3  65.2473  73.0628  65.4973 -29.6237                207.6566 0.0538 
Reduced  2 106.0854 111.2958 106.2092 -51.0427 42.8381 &lt;.0001 325.8480 0.1114 
             R^2 
Full             
Reduced 51.7500% </code></pre>
</div>
</div>
</section><section id="r2" class="slide level2"><h2><span class="math inline">\(R^2\)</span></h2>
<p>The <span class="math inline">\(R^2\)</span> value reported in the model output is not calculated as in standard regression analysis.</p>
<p><span class="math display">\[
R^2 = 1 - \frac{\tau^2_r}{\tau^2}
\]</span></p>
<p>Basically is the percentage of heterogeneity reduction from the intercept-only model to the model including predictors.</p>
<p>In R:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 50.52961</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 50.52961</code></pre>
</div>
</div>
</section><section id="r2-1" class="slide level2"><h2><span class="math inline">\(R^2\)</span></h2>
<p>Despite useful, the <span class="math inline">\(R^2\)</span> has some limitations:</p>
<ul>
<li>
<span class="citation" data-cites="Lopez-Lopez2014-it">López-López et al. (<a href="#/references" role="doc-biblioref" onclick="">2014</a>)</span> showed that precise estimations require a large number of studies <span class="math inline">\(k\)</span>
</li>
<li>Sometimes could results in negative values (usually truncated to zero)</li>
<li>Depends on the <span class="math inline">\(\tau^2\)</span> estimator</li>
</ul>
<p>More about <span class="math inline">\(R^2\)</span> and limitations can be found:</p>
<ul>
<li><a href="https://www.metafor-project.org/doku.php/faq#for_mixed-effects_models_how_i">https://www.metafor-project.org/doku.php/faq#for_mixed-effects_models_how_i</a></li>
<li><a href="https://www.metafor-project.org/doku.php/tips:ci_for_r2">https://www.metafor-project.org/doku.php/tips:ci_for_r2</a></li>
</ul></section><section id="numerical-predictor" class="slide level2"><h2>Numerical predictor</h2>
<p>The same logic of simulating a meta-regression can be applied to numerical predictors. We still have <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> but <span class="math inline">\(X\)</span> has more levels. Let’s simulate an impact of the average participants’ age on the effect size.</p>
<ul>
<li>
<span class="math inline">\(\beta_0\)</span> is the effect size when <strong>age</strong> is zero</li>
<li>
<span class="math inline">\(\beta_1\)</span> is the expected increase in the effect size for a unit increase in <code>age</code>
</li>
</ul>
<p>How we can choose plausible values for the parameters and parametrize the model correctly?</p>
</section><section id="parametrize-beta_0" class="slide level2"><h2>Parametrize <span class="math inline">\(\beta_0\)</span>
</h2>
<p>The intepretation (and the inference) of <span class="math inline">\(\beta_0\)</span> is strongly dependent on the type of numerical predictor. An age of zero is (probably) empirically meaningless thus the <span class="math inline">\(\beta_0\)</span> is somehow not useful.</p>
<p>We can for example mean-center (or other type of centering procedure) moving the zero on a meaningful value.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">:</span><span class="fl">50</span> <span class="co"># the raw vector</span></span>
<span><span class="va">age0</span> <span class="op">&lt;-</span> <span class="va">age</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span> <span class="co"># centering on the mean</span></span>
<span><span class="va">age20</span> <span class="op">&lt;-</span> <span class="va">age</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span> <span class="co"># centering on the minimum</span></span>
<span></span>
<span><span class="fu">ht</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">age0</span>, <span class="va">age20</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   age age0 age20
1   10  -20     0
2   11  -19     1
3   12  -18     2
4   13  -17     3
5   14  -16     4
36  45   15    35
37  46   16    36
38  47   17    37
39  48   18    38
40  49   19    39
41  50   20    40</code></pre>
</div>
</div>
</section><section id="parametrize-beta_0-1" class="slide level2"><h2>Parametrize <span class="math inline">\(\beta_0\)</span>
</h2>

<img data-src="meta-regression_files/figure-revealjs/unnamed-chunk-15-1.png" width="960" class="r-stretch"></section><section id="parametrize-beta_0-2" class="slide level2"><h2>Parametrize <span class="math inline">\(\beta_0\)</span>
</h2>
<p>Using different parametrizations will only affect the estimation (and the interpretation) of <span class="math inline">\(\beta_0\)</span>. Other parameters and indexes will be the same.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">b0</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="co"># effect size when age 0</span></span>
<span><span class="va">b1</span> <span class="op">&lt;-</span> <span class="fl">0.05</span> <span class="co"># slope (random for now)</span></span>
<span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">k</span>, <span class="fl">20</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span> <span class="co"># sampling from uniform distribution</span></span>
<span><span class="va">tau2r</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="va">k</span>, <span class="fl">30</span> <span class="op">-</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">es</span> <span class="op">&lt;-</span> <span class="va">b0</span> <span class="op">+</span> <span class="va">b1</span> <span class="op">*</span> <span class="va">age</span> <span class="co"># raw</span></span>
<span></span>
<span><span class="va">age0</span> <span class="op">&lt;-</span> <span class="va">age</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span></span>
<span><span class="va">age20</span> <span class="op">&lt;-</span> <span class="va">age</span> <span class="op">-</span> <span class="fl">20</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span>k <span class="op">=</span> <span class="va">k</span>, es <span class="op">=</span> <span class="va">es</span>, tau2 <span class="op">=</span> <span class="va">tau2r</span>, n1 <span class="op">=</span> <span class="va">n</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>age <span class="op">=</span> <span class="va">age</span>, age0 <span class="op">=</span> <span class="va">age0</span>, age20 <span class="op">=</span> <span class="va">age20</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">rma</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, mods <span class="op">=</span> <span class="op">~</span> <span class="va">age</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span><span class="va">fit0</span> <span class="op">&lt;-</span> <span class="fu">rma</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, mods <span class="op">=</span> <span class="op">~</span> <span class="va">age0</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span><span class="va">fit20</span> <span class="op">&lt;-</span> <span class="fu">rma</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, mods <span class="op">=</span> <span class="op">~</span> <span class="va">age20</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># showing the intercept</span></span>
<span><span class="fu">compare_rma</span><span class="op">(</span><span class="va">fit</span>, <span class="va">fit0</span>, <span class="va">fit20</span>, extra_params <span class="op">=</span> <span class="st">"R2"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>fit: rma(yi = yi, vi = vi, mods = ~age, data = dat)
fit0: rma(yi = yi, vi = vi, mods = ~age0, data = dat)
fit20: rma(yi = yi, vi = vi, mods = ~age20, data = dat)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>               fit   fit0  fit20
b (intrcpt)  0.177  1.909  1.159
se           0.157  0.038  0.076
zval         1.130 50.372 15.308
pval         0.259  0.000  0.000
ci.lb       -0.130  1.835  1.011
ci.ub        0.484  1.983  1.308
R2          70.229 70.229 70.229
I2          54.369 54.369 54.369
tau2         0.077  0.077  0.077</code></pre>
</div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>  <span class="co"># showing the intercept</span></span>
<span><span class="fu">compare_rma</span><span class="op">(</span><span class="va">fit</span>, <span class="va">fit0</span>, <span class="va">fit20</span>, b <span class="op">=</span> <span class="st">"age"</span>, extra_params <span class="op">=</span> <span class="st">"R2"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>fit: rma(yi = yi, vi = vi, mods = ~age, data = dat)
fit0: rma(yi = yi, vi = vi, mods = ~age0, data = dat)
fit20: rma(yi = yi, vi = vi, mods = ~age20, data = dat)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>           fit   fit0  fit20
b (age)  0.049  0.049  0.049
se       0.004  0.004  0.004
zval    11.366 11.366 11.366
pval     0.000  0.000  0.000
ci.lb    0.041  0.041  0.041
ci.ub    0.058  0.058  0.058
R2      70.229 70.229 70.229
I2      54.369 54.369 54.369
tau2     0.077  0.077  0.077</code></pre>
</div>
</div>
</section><section id="choosing-beta_1" class="slide level2"><h2>Choosing <span class="math inline">\(\beta_1\)</span>
</h2>
<p>The core of the model is <span class="math inline">\(\beta_1\)</span> that is the <strong>age</strong> effect. Compared to the categorical case where <span class="math inline">\(\beta_1\)</span> is just the standardized difference between two conditions, with numerical <span class="math inline">\(X\)</span> choosing a meaningful <span class="math inline">\(\beta_1\)</span> is more challenging.</p>
<p>Two (maybe more) strategies:</p>
<ul>
<li>simulating a lot of effects sizes fixing <span class="math inline">\(beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> and see the expected range of <span class="math inline">\(y_i\)</span>
</li>
<li>fixing a certain <span class="math inline">\(R^2\)</span> and choose the <span class="math inline">\(\beta_1\)</span> producing that <span class="math inline">\(R^2\)</span>
</li>
<li>…</li>
</ul></section><section id="beta_1-by-simulations" class="slide level2"><h2>
<span class="math inline">\(\beta_1\)</span> by simulations</h2>
<p>A strategy could be to simulate from the generative model a large number of studies and see the expected range of effect size <span class="citation" data-cites="Gelman2020-tg">(<a href="#/references" role="doc-biblioref" onclick="">Gelman, Hill, and Vehtari 2020, chap. 5</a> and p.&nbsp;97)</span>. A large number of unplausible values suggest that the chosen <span class="math inline">\(\beta_1\)</span> is probably not appropriate.</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">1e3</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">tau2</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">k</span>, <span class="fl">20</span>, <span class="fl">50</span><span class="op">)</span> <span class="co"># age</span></span>
<span><span class="va">b0</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="va">b1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.05</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">esl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">b1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">b</span><span class="op">)</span> <span class="va">b0</span> <span class="op">+</span> <span class="va">b</span><span class="op">*</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">datl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">esl</span>, <span class="kw">function</span><span class="op">(</span><span class="va">es</span><span class="op">)</span> <span class="fu">sim_studies</span><span class="op">(</span>k <span class="op">=</span> <span class="va">k</span>, es <span class="op">=</span> <span class="va">es</span>, tau2 <span class="op">=</span> <span class="va">tau2</span>, n1 <span class="op">=</span> <span class="va">n</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">datl</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">b1</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="va">datl</span>, .id <span class="op">=</span> <span class="st">"b1"</span><span class="op">)</span></span>
<span><span class="fu">ht</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##         b1   id      yi     vi n1 n2        x </span></span>
<span><span class="co">## 1    0.001    1  0.0119 0.0689 30 30 25.39193 </span></span>
<span><span class="co">## 2    0.001    2 -0.0592 0.0626 30 30 46.96575 </span></span>
<span><span class="co">## 3    0.001    3 -0.0670 0.0694 30 30 44.98784 </span></span>
<span><span class="co">## 4    0.001    4  0.6036 0.0813 30 30 21.47130 </span></span>
<span><span class="co">## 5    0.001    5 -0.1416 0.0833 30 30 27.83832 </span></span>
<span><span class="co">## 2995   0.2  995  9.5025 0.0380 30 30 43.84276 </span></span>
<span><span class="co">## 2996   0.2  996  7.4130 0.0663 30 30 37.10261 </span></span>
<span><span class="co">## 2997   0.2  997  9.4021 0.0712 30 30 46.46504 </span></span>
<span><span class="co">## 2998   0.2  998  4.5550 0.0832 30 30 21.37765 </span></span>
<span><span class="co">## 2999   0.2  999  5.4775 0.0750 30 30 27.05406 </span></span>
<span><span class="co">## 3000   0.2 1000  5.6702 0.0554 30 30 29.61812</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="beta_1-by-simulations-1" class="slide level2"><h2>
<span class="math inline">\(\beta_1\)</span> by simulations</h2>
<p>Clearly given the limited range of the <span class="math inline">\(x\)</span> variable (<code>age</code>) some <span class="math inline">\(\beta_1\)</span> values are implausible leading to effect sizes that are out of a meaningful empirical range.</p>

<img data-src="meta-regression_files/figure-revealjs/unnamed-chunk-18-1.png" width="960" class="r-stretch"></section><section id="fixing-r2" class="slide level2"><h2>Fixing <span class="math inline">\(R^2\)</span>
</h2>
<p>We can use the approach by <span class="citation" data-cites="Lopez-Lopez2014-it">López-López et al. (<a href="#/references" role="doc-biblioref" onclick="">2014</a>)</span> where predictors <span class="math inline">\(x\)</span> are sampled from a standard normal distribution (or standardized). <span class="math inline">\(\beta_1\)</span> is calculated as <span class="math inline">\(\beta_1 = \sqrt{\tau^2 R^2}\)</span> and the residual heterogeneity as <span class="math inline">\(\tau^2_r = \tau^2 - \beta^2_1\)</span>.</p>
</section><section id="fixing-r2-1" class="slide level2"><h2>Fixing <span class="math inline">\(R^2\)</span>
</h2>
<p>We can check the simulation approach:</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">1e3</span></span>
<span><span class="fl">1</span> <span class="op">-</span> <span class="va">tau2r</span><span class="op">/</span><span class="va">tau2</span></span>
<span><span class="co">## [1] 0.4</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span></span>
<span><span class="va">es</span> <span class="op">&lt;-</span> <span class="va">b0</span> <span class="op">+</span> <span class="va">b1</span> <span class="op">*</span> <span class="va">x</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span><span class="va">k</span>, <span class="va">es</span>, <span class="va">tau2r</span>, n1 <span class="op">=</span> <span class="fl">1e3</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">rma</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data <span class="op">=</span> <span class="va">dat</span>, mods <span class="op">=</span> <span class="op">~</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mixed-Effects Model (k = 1000; tau^2 estimator: REML)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    logLik   deviance        AIC        BIC       AICc   </span></span>
<span><span class="co">## -521.1960  1042.3919  1048.3919  1063.1092  1048.4161   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## tau^2 (estimated amount of residual heterogeneity):     0.1644 (SE = 0.0074)</span></span>
<span><span class="co">## tau (square root of estimated tau^2 value):             0.4055</span></span>
<span><span class="co">## I^2 (residual heterogeneity / unaccounted variability): 98.80%</span></span>
<span><span class="co">## H^2 (unaccounted variability / sampling variability):   83.36</span></span>
<span><span class="co">## R^2 (amount of heterogeneity accounted for):            42.50%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Test for Residual Heterogeneity:</span></span>
<span><span class="co">## QE(df = 998) = 83263.7030, p-val &lt; .0001</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Test of Moderators (coefficient 2):</span></span>
<span><span class="co">## QM(df = 1) = 730.4726, p-val &lt; .0001</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model Results:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##          estimate      se     zval    pval   ci.lb   ci.ub      </span></span>
<span><span class="co">## intrcpt    0.1062  0.0129   8.2329  &lt;.0001  0.0809  0.1315  *** </span></span>
<span><span class="co">## x          0.3531  0.0131  27.0273  &lt;.0001  0.3275  0.3787  *** </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="r2-using-simulations" class="slide level2"><h2>
<span class="math inline">\(R^2\)</span> using simulations</h2>
<p>The results from <span class="citation" data-cites="Lopez-Lopez2014-it">López-López et al. (<a href="#/references" role="doc-biblioref" onclick="">2014</a>)</span> (and also our previous simulation) suggested that we need a large number of studies for precise <span class="math inline">\(R^2\)</span> estimations. Let’s check using simulations the sampling distribution of <span class="math inline">\(R^2\)</span> using a plausible meta-analysis scenario.</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">40</span> <span class="co"># number of studies</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="va">k</span>, <span class="fl">40</span> <span class="op">-</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># sample size</span></span>
<span><span class="va">tau2</span> <span class="op">&lt;-</span> <span class="fl">0.05</span> <span class="co"># tau ~ 0.22</span></span>
<span><span class="va">R2</span> <span class="op">&lt;-</span> <span class="fl">0.3</span></span>
<span><span class="va">b0</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="va">b1_2</span> <span class="op">&lt;-</span> <span class="va">tau2</span> <span class="op">*</span> <span class="va">R2</span></span>
<span><span class="va">b1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">b1_2</span><span class="op">)</span></span>
<span><span class="va">tau2r</span> <span class="op">&lt;-</span> <span class="va">tau2</span> <span class="op">-</span> <span class="va">b1_2</span></span>
<span><span class="va">nsim</span> <span class="op">&lt;-</span> <span class="fl">1e3</span></span>
<span></span>
<span><span class="va">R2i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">nsim</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nsim</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span></span>
<span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span>k <span class="op">=</span> <span class="va">k</span>, es <span class="op">=</span> <span class="va">b0</span> <span class="op">+</span> <span class="va">b1</span><span class="op">*</span><span class="va">x</span>, tau2 <span class="op">=</span> <span class="va">tau2r</span>, n1 <span class="op">=</span> <span class="va">n</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">rma</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data <span class="op">=</span> <span class="va">dat</span>, mods <span class="op">=</span> <span class="op">~</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">R2i</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">R2</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="r2-using-simulations-1" class="slide level2"><h2>
<span class="math inline">\(R^2\)</span> using simulations</h2>
<p>We estimated the true <span class="math inline">\(R^2\)</span> correctly but there is a lot of uncertainty with a plausible meta-analysis scenario. There are a lot of meta-analysis also with lower <span class="math inline">\(k\)</span> worsening the results.</p>

<img data-src="meta-regression_files/figure-revealjs/unnamed-chunk-22-1.png" width="960" class="r-stretch"></section><section id="references" class="slide level2 smaller scrollable"><h2>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Gelman2020-tg" class="csl-entry" role="listitem">
Gelman, Andrew, Jennifer Hill, and Aki Vehtari. 2020. <em>Regression and Other Stories</em>. Cambridge University Press. <a href="https://doi.org/10.1017/9781139161879">https://doi.org/10.1017/9781139161879</a>.
</div>
<div id="ref-Lopez-Lopez2014-it" class="csl-entry" role="listitem">
López-López, José Antonio, Fulgencio Marín-Martínez, Julio Sánchez-Meca, Wim Van den Noortgate, and Wolfgang Viechtbauer. 2014. <span>“Estimation of the Predictive Power of the Model in Mixed-Effects Meta-Regression: A Simulation Study.”</span> <em>The British Journal of Mathematical and Statistical Psychology</em> 67 (February): 30–48. <a href="https://doi.org/10.1111/bmsp.12002">https://doi.org/10.1111/bmsp.12002</a>.
</div>
<div id="ref-Schad2020-ht" class="csl-entry" role="listitem">
Schad, Daniel J, Shravan Vasishth, Sven Hohenstein, and Reinhold Kliegl. 2020. <span>“How to Capitalize on a Priori Contrasts in Linear (Mixed) Models: A Tutorial.”</span> <em>Journal of Memory and Language</em> 110 (February): 104038. <a href="https://doi.org/10.1016/j.jml.2019.104038">https://doi.org/10.1016/j.jml.2019.104038</a>.
</div>
</div>


</section><div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div></section><!-- FINAL SLIDE --><!-- END FINAL SLIDE -->
</div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="../../site_libs/revealjs/dist/reveal.js"></script><!-- reveal.js plugins --><script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script><script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script><script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script><script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script><script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script><script src="../../site_libs/revealjs/plugin/notes/notes.js"></script><script src="../../site_libs/revealjs/plugin/search/search.js"></script><script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script><script src="../../site_libs/revealjs/plugin/math/math.js"></script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script><script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script><script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>


</body></html>