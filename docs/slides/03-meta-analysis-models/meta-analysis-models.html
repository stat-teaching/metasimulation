<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/quarto-contrib/jquery-3.6.3/jquery-3.6.3.min.js"></script>
<script src="../../site_libs/quarto-contrib/code-fullscreen-1.0.0/code-fullscreen.js" defer="true"></script>
<link href="../../site_libs/quarto-contrib/code-fullscreen-1.0.0/code-fullscreen.css" rel="stylesheet">
<script src="../../site_libs/quarto-contrib/nutshell-1.0.0/nutshell.min.js"></script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<meta charset="utf-8">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" rel="stylesheet">
<meta name="generator" content="quarto-1.4.527">
<meta name="author" content="Filippo Gambarota">
<meta name="author" content="Gianmarco AltoÃ¨">
<meta name="dcterms.date" content="2024-02-08">
<title>Meta-analysis Workshop - Meta-analysis Models</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
<link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
<link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto.css">
<link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
<link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
<link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
<link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
<style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
<style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="center"><h1 class="title">Meta-analysis Models</h1>
  <p class="subtitle">CSA 2024</p>
  <p class="author">Filippo Gambarota</p>
  <p class="author">Gianmarco AltoÃ¨</p>
  <p class="institute">Department of Developmental Psychology and Socialization, University of Padova</p>
  <p class="date">08 February 2024</p>
</section><section><section id="simulation-setup" class="title-slide slide level1 section center"><h1>Simulation setup</h1>

</section><section id="notation" class="slide level2 smaller"><h2>Notation</h2>
<p>Meta-analysis notation is a little bit inconsistent in textbooks and papers. We define here some rules to simplify the work.</p>
<ul>
<li>
<span class="math inline">\(k\)</span> is the number of studies</li>
<li>
<span class="math inline">\(n_j\)</span> is the sample size of the group <span class="math inline">\(j\)</span> within a study</li>
<li>
<span class="math inline">\(y_i\)</span> are the observed effect size included in the meta-analysis</li>
<li>
<span class="math inline">\(\sigma_i^2\)</span> are the observed sampling variance of studies and <span class="math inline">\(\epsilon_i\)</span> are the sampling errors</li>
<li>
<span class="math inline">\(\theta\)</span> is the equal-effects parameter (see <a href="#/ee-meta-analysis-formally" class="quarto-xref">Equation&nbsp;1</a>)</li>
<li>
<span class="math inline">\(\delta_i\)</span> is the random-effect (see <a href="#/random-effects-model-re" class="quarto-xref">Equation&nbsp;4</a>)</li>
<li>
<span class="math inline">\(\mu_\theta\)</span> is the average effect of a random-effects model (see <a href="#/random-effects-model-re" class="quarto-xref">Equation&nbsp;3</a>)</li>
<li>
<span class="math inline">\(w_i\)</span> are the meta-analysis weights (e.g., see <strong>?@eq-wi</strong>)</li>
<li>
<span class="math inline">\(\tau^2\)</span> is the heterogeneity (see <a href="#/random-effects-model-re" class="quarto-xref">Equation&nbsp;4</a>)</li>
<li>
<span class="math inline">\(\Delta\)</span> is the (generic) population effect size</li>
<li>
<span class="math inline">\(s_j^2\)</span> is the variance of the group <span class="math inline">\(j\)</span> within a study</li>
</ul></section><section id="simulation-setup-1" class="slide level2"><h2>Simulation setup</h2>
<p>Given the introduction to effect sizes, from now we will simulate data using UMD and the individual-level data.</p>
<p>Basically we are simulating an effect size <span class="math inline">\(D\)</span> coming from the comparison of two independent groups <span class="math inline">\(G_1\)</span> and <span class="math inline">\(G_2\)</span>.</p>
<p>Each group is composed by <span class="math inline">\(n\)</span> participants measured on a numerical outcome (e.g., reaction times)</p>
</section><section id="simulation-setup-2" class="slide level2"><h2>Simulation setup</h2>
<p>A more general, clear and realistic approach to simulate data is by generating <span class="math inline">\(k\)</span> studies with same/different sample sizes and (later) true effect sizes.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="co"># number of studies</span></span>
<span><span class="va">n1</span> <span class="op">&lt;-</span> <span class="va">n2</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="va">k</span>, <span class="fl">30</span> <span class="op">-</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># sample size from poisson distribution with lambda 40 and minimum 10</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="co"># effect size</span></span>
<span></span>
<span><span class="va">yi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">k</span><span class="op">)</span></span>
<span><span class="va">vi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">k</span><span class="op">)</span></span>
<span>  </span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">k</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">D</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">yi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span></span>
<span>  <span class="va">vi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span><span class="op">/</span><span class="va">n1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span><span class="op">/</span><span class="va">n2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span>  </span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">k</span>, <span class="va">yi</span>, <span class="va">vi</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  id          yi         vi
1  1  0.49421982 0.08288862
2  2  0.06888314 0.06218928
3  3  0.99615108 0.04095767
4  4 -0.01485818 0.11610287
5  5  0.76019826 0.07583588
6  6  0.13438757 0.05016794</code></pre>
</div>
</div>
</section><section id="simulation-setup-3" class="slide level2"><h2>Simulation setup</h2>
<p>We can again put everything within a function:</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sim_studies</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">k</span>, <span class="va">es</span>, <span class="va">n1</span>, <span class="va">n2</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">n1</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="va">n1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">n1</span>, <span class="va">k</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">n2</span><span class="op">)</span><span class="op">)</span> <span class="va">n2</span> <span class="op">&lt;-</span> <span class="va">n1</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">es</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="va">es</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">es</span>, <span class="va">k</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">yi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">k</span><span class="op">)</span></span>
<span>  <span class="va">vi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">k</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">k</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">es</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">yi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span></span>
<span>    <span class="va">vi</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span><span class="op">/</span><span class="va">n1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span><span class="op">/</span><span class="va">n2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">k</span>, <span class="va">yi</span>, <span class="va">vi</span>, n1 <span class="op">=</span> <span class="va">n1</span>, n2 <span class="op">=</span> <span class="va">n2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># convert to escalc for using metafor methods</span></span>
<span>  <span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu">metafor</span><span class="fu">::</span><span class="fu"><a href="https://wviechtb.github.io/metafor/reference/escalc.html">escalc</a></span><span class="op">(</span>yi <span class="op">=</span> <span class="va">yi</span>, vi <span class="op">=</span> <span class="va">vi</span>, data <span class="op">=</span> <span class="va">sim</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="simulation-setup---disclaimer" class="slide level2"><h2>Simulation setup - Disclaimer</h2>
<p>The proposed simulation approach using a <code>for</code> loop and separated vectors. For the purposed of the workshop this is the best option. In real-world meta-analysis simulations you can choose a more functional approach starting from a simulation grid as <code>data.frame</code> and mapping the simulation functions.</p>
<p>For some examples see:</p>
<ul>
<li><span class="citation" data-cites="Gambarota2023-on">Gambarota and AltoÃ¨ (<a href="#/references" role="doc-biblioref" onclick="">2023</a>)</span></li>
<li><a href="https://www.jepusto.com/simulating-correlated-smds">www.jepusto.com/simulating-correlated-smds</a></li>
</ul></section></section><section><section id="combining-studies" class="title-slide slide level1 section center"><h1>Combining studies</h1>

</section><section id="combining-studies-1" class="slide level2"><h2>Combining studies</h2>
<p>Letâs imagine to have <span class="math inline">\(k = 10\)</span> studies, a <span class="math inline">\(D = 0.5\)</span> and heterogeneous sample sizes in each study.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="va">k</span>, lambda <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> </span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span>k <span class="op">=</span> <span class="va">k</span>, es <span class="op">=</span> <span class="va">D</span>, n1 <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  id     yi     vi n1 n2 
1  1 0.3586 0.0603 33 33 
2  2 0.4221 0.0700 30 30 
3  3 0.2664 0.0691 30 30 
4  4 0.3958 0.0404 35 35 
5  5 0.6521 0.0819 34 34 
6  6 0.5336 0.0697 39 39 </code></pre>
</div>
</div>
<div class="fragment">
<p>What is the best way to combine the studies?</p>
</div>
</section><section id="combining-studies-2" class="slide level2"><h2>Combining studies</h2>
<p>We can take the average effect size and considering it as a huge study. This can be considered the best way to combine the effects.</p>
<p><span class="math display">\[
\hat{D} = \frac{\sum^{k}_{i = 1} D_i}{k}
\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">yi</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.4030441</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>It is appropriate? What do you think? Are we missing something?</p>
</div>
</section><section id="weighting-studies" class="slide level2"><h2>Weighting studies</h2>
<p>We are not considering that some studies, despite providing a similar effect size could give more information. An higher sample size (or lower sampling variance) produce a more reliable estimation.</p>
<div class="fragment">
<p>Would you trust more a study with <span class="math inline">\(n = 100\)</span> and <span class="math inline">\(D = 0.5\)</span> or a study with <span class="math inline">\(n = 10\)</span> and <span class="math inline">\(D = 0.5\)</span>? The âmeta-analysisâ that we did before is completely ignoring this information.</p>
</div>
</section><section id="weighting-studies-1" class="slide level2"><h2>Weighting studies</h2>
<p>We need to find a value (called weight <span class="math inline">\(w_i\)</span>) that allows assigning more trust to a study because it provide more information.</p>
<div class="fragment">
<p>The simplest weights are just the sample size, but in practice we use the so-called <strong>inverse-variance weighting</strong>. We use the (inverse) of the sampling variance of the effect size to weight each study.</p>
</div>
<div class="fragment">
<p>The basic version of a meta-analysis is just a <strong>weighted average</strong>:</p>
<p><span class="math display">\[
\overline D_w = \frac{\sum^k_{i = 1}{w_iD_i}}{\sum^k_{i = 1}{w_i}}
\]</span></p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">wi</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">dat</span><span class="op">$</span><span class="va">vi</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">yi</span> <span class="op">*</span> <span class="va">wi</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">wi</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3925842</code></pre>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># weighted.mean(dat$yi, wi)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section><section id="weighting-studies-2" class="slide level2"><h2>Weighting studies</h2>
<p>Graphically, the two models can be represented in this way:</p>

<img data-src="meta-analysis-models_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch"></section></section><section><section id="equal-effects-ee-meta-analysis" class="title-slide slide level1 section center"><h1>Equal-effects (EE) meta-analysis</h1>

</section><section id="ee-meta-analysis" class="slide level2"><h2>EE meta-analysis</h2>
<p>What we did in the last example (the weighted mean) is the exactly a meta-analysis model called <strong>equal-effects</strong> (or less precisely fixed-effect). The assumptions are very simple:</p>
<ul>
<li>there is a unique, true effect size to estimate <span class="math inline">\(\theta\)</span>
</li>
<li>each study is a more or less precise estimate of <span class="math inline">\(\theta\)</span>
</li>
<li>there is no TRUE variability among studies. The observed variability is due to studies that are imprecise (i.e., sampling error)</li>
<li>assuming that each study has a very large sample size, the observed variability is close to zero.</li>
</ul></section><section id="ee-meta-analysis-formally" class="slide level2"><h2>EE meta-analysis, formally</h2>
<p><span id="eq-ee1"><span class="math display">\[
y_i = \theta + \epsilon_i
\tag{1}\]</span></span></p>
<p><span id="eq-ee2"><span class="math display">\[
\epsilon_i \sim \mathcal{N}(0, \sigma^2_i)
\tag{2}\]</span></span></p>
<p>Where <span class="math inline">\(\sigma^2_i\)</span> is the vector of sampling variabilities of <span class="math inline">\(k\)</span> studies. This is a standard linear model but with heterogeneous sampling variances.</p>
</section><section id="ee-meta-analysis-1" class="slide level2"><h2>EE meta-analysis</h2>

<img data-src="meta-analysis-models_files/figure-revealjs/unnamed-chunk-9-1.png" width="960" class="r-stretch"></section><section id="simulating-an-ee-model" class="slide level2"><h2>Simulating an EE model</h2>
<p>What we were doing with the <code>sim_studies()</code> function so far was simulating an EE model. In fact, there were a single <span class="math inline">\(\theta\)</span> parameter and the observed variability was a function of the <code><a href="https://rdrr.io/r/stats/Normal.html">rnorm()</a></code> randomness.</p>
<p>Based on previous assumptions and thinking a little bit, what could be the result of simulating studies with a very large <span class="math inline">\(n\)</span>?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">1000</span>, <span class="fl">1e4</span><span class="op">)</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">dats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">ns</span>, <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu">sim_studies</span><span class="op">(</span><span class="fl">10</span>, es <span class="op">=</span> <span class="va">D</span>, n1 <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section><section id="sec-ee-impact-n" class="slide level2"><h2>Simulating an EE modelm</h2>

<img data-src="meta-analysis-models_files/figure-revealjs/unnamed-chunk-11-1.png" width="960" class="r-stretch"></section><section id="simulating-an-ee-model-1" class="slide level2"><h2>Simulating an EE model</h2>
<p>Formulating the model as a intercept-only regression (see Equations <a href="#/ee-meta-analysis-formally" class="quarto-xref">Equation&nbsp;1</a> and <a href="#/ee-meta-analysis-formally" class="quarto-xref">Equation&nbsp;2</a>) we can generate data directly:</p>
<p>As we did for the aggregated data approach. Clearly we need to simulate also the <code>vi</code> vector from the appropriate distribution. Given that we simulated data starting from the participant-level the uncertainty of <code>yi</code> and <code>vi</code> is already included.</p>
</section><section id="fitting-an-ee-model" class="slide level2"><h2>Fitting an EE model</h2>
<p>The model can be fitted using the <code><a href="https://wviechtb.github.io/metafor/reference/rma.uni.html">metafor::rma()</a></code> function, with <code>method = "EE"</code><sup>1</sup>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Equal-Effects Model (k = 15)

  logLik  deviance       AIC       BIC      AICc   
 -4.1179   20.6172   10.2359   10.9439   10.5435   

I^2 (total heterogeneity / total variability):   32.10%
H^2 (total variability / sampling variability):  1.47

Test for Heterogeneity:
Q(df = 14) = 20.6172, p-val = 0.1119

Model Results:

estimate      se    zval    pval   ci.lb   ci.ub      
  0.5576  0.0674  8.2702  &lt;.0001  0.4254  0.6897  *** 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn1"><p>There is a confusion about the <em>fixed-effects</em> vs <em>fixed-effect</em> (no <em>s</em>) and <em>equal-effects</em> models. See <a href="https://wviechtb.github.io/metafor/reference/misc-models.html">https://wviechtb.github.io/metafor/reference/misc-models.html</a></p></li></ol></aside></section><section id="interpreting-an-ee-model" class="slide level2"><h2>Interpreting an EE model</h2>
<ul>
<li>The first section (<code>logLik</code>, <code>deviance</code>, etc.) presents some general model statistics and information criteria</li>
<li>The <span class="math inline">\(I^2\)</span> and <span class="math inline">\(H^2\)</span> are statistics evaluating the observed heterogeneity (see next slides)</li>
<li>The <code>Test of Heterogeneity</code> section presents the test of the <span class="math inline">\(Q\)</span> statistics for the observed heterogeneity (see next slides)</li>
<li>The <code>Model Results</code> section presents the estimation of the <span class="math inline">\(\theta\)</span> parameter along with the standard error and the Wald <span class="math inline">\(z\)</span> test (<span class="math inline">\(H_0: \theta = 0\)</span>)</li>
</ul>
<p>The <code>metafor</code> package has a several well documented functions to calculate and plot model results, residuals analysis etc.</p>
</section><section id="interpreting-an-ee-model-1" class="slide level2"><h2>Interpreting an EE model</h2>

<img data-src="meta-analysis-models_files/figure-revealjs/unnamed-chunk-14-1.png" width="960" class="r-stretch"></section><section id="interpreting-an-ee-model-2" class="slide level2"><h2>Interpreting an EE Model</h2>
<p>The main function for plotting model results is the <code>forest()</code> function that produce the forest plot.</p>

<img data-src="meta-analysis-models_files/figure-revealjs/unnamed-chunk-15-1.png" width="960" class="r-stretch"></section><section id="interpreting-an-ee-model-3" class="slide level2"><h2>Interpreting an EE Model</h2>
<p>We did not introduced the concept of heterogeneity, but the <span class="math inline">\(I^2\)</span>, <span class="math inline">\(H^2\)</span> and <span class="math inline">\(Q\)</span> statistics basically evaluate if the observed heterogeneity should be attributed to <strong>sampling variability</strong> (uncertainty in estimating <span class="math inline">\(\theta\)</span> because we have a limited <span class="math inline">\(k\)</span> and <span class="math inline">\(n\)</span>) or <strong>sampling variability</strong> plus other sources of heterogeneity.</p>
</section><section id="ee-model-as-a-weighted-average" class="slide level2"><h2>EE model as a weighted Average</h2>
<p>Formally <span class="math inline">\(\theta\)</span> is estimated as <span class="citation" data-cites="Borenstein2009-mo">(see <a href="#/references" role="doc-biblioref" onclick="">Borenstein et al. 2009, 66</a>)</span></p>
<p><span class="math display">\[
\hat{\theta} = \frac{\sum^k_{i = 1}{w_iy_i}}{\sum^k_{i = 1}{w_i}}; \;\;\; w_i = \frac{1}{\sigma^2_i}
\]</span></p>
<p><span class="math display">\[
SE_{\theta} = \frac{1}{\sum^k_{i = 1}{w_i}}
\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">wi</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">dat</span><span class="op">$</span><span class="va">vi</span></span>
<span><span class="va">theta_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">yi</span> <span class="op">*</span> <span class="va">wi</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">wi</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">se_theta_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">wi</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="va">theta_hat</span>, se <span class="op">=</span> <span class="va">se_theta_hat</span>, z <span class="op">=</span> <span class="va">theta_hat</span> <span class="op">/</span> <span class="va">se_theta_hat</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     theta         se          z 
0.55758541 0.06742079 8.27022993 </code></pre>
</div>
</div>
</section></section><section><section id="random-effects-re-meta-analysis" class="title-slide slide level1 section center"><h1>Random-effects (RE) meta-analysis</h1>

</section><section id="are-the-ee-assumptions-realistic" class="slide level2"><h2>Are the EE assumptions realistic?</h2>
<p>The EE model is appropriate if our studies are somehow <strong>exact replications</strong> of the exact same effect. We are assuming that there is <strong>no real variability</strong>.</p>
<div class="fragment">
<p>However, meta-analysis rarely report the results of <span class="math inline">\(k\)</span> exact replicates. It is more common to include <strong>studies answering the same research question</strong> but with different methods, participants, etc.</p>
</div>
<div class="fragment">
<ul>
<li>people with different ages or other participant-level differences</li>
<li>different methodology</li>
<li>â¦</li>
</ul>
</div>
</section><section id="are-the-ee-assumptions-realistic-1" class="slide level2"><h2>Are the EE assumptions realistic?</h2>
<div class="fragment">
<p>If we relax the previous assumption we are able to combine studies that are not exact replications.</p>
</div>
<div class="fragment">
<p>Thus the real effect <span class="math inline">\(\theta\)</span> is no longer a single <strong>true</strong> value but can be larger or smaller in some conditions.</p>
</div>
<div class="fragment">
<p>In other terms we are assuming that there could be some variability (i.e., <strong>heterogeneity</strong>) among studies that is independent from the sample size. Even with studies with <span class="math inline">\(\lim_{n\to\infty}\)</span> the observed variability is not zero.</p>
</div>
</section><section id="random-effects-model-re" class="slide level2"><h2>Random-effects model (RE)</h2>
<p>We can extend the EE model including another source of variability, <span class="math inline">\(\tau^2\)</span>. <span class="math inline">\(\tau^2\)</span> is the true heterogeneity among studies caused by methdological differences or intrisic variability in the phenomenon.</p>
<p>Formally we can extend <a href="#/ee-meta-analysis-formally" class="quarto-xref">Equation&nbsp;1</a> as: <span id="eq-re-mod1"><span class="math display">\[
y_i = \mu_{\theta} + \delta_i + \epsilon_i
\tag{3}\]</span></span></p>
<p><span id="eq-re-mod2"><span class="math display">\[
\delta_i \sim \mathcal{N}(0, \tau^2)
\tag{4}\]</span></span></p>
<p><span class="math display">\[
\epsilon_i \sim \mathcal{N}(0, \sigma^2_i)
\]</span></p>
<p>Where <span class="math inline">\(\mu_{\theta}\)</span> is the average effect size and <span class="math inline">\(\delta_i\)</span> is the study-specific deviation from the average effect (regulated by <span class="math inline">\(\tau^2\)</span>). Clearly each study specific effect is <span class="math inline">\(\theta_i = \mu_{\theta} + \delta_i\)</span>.</p>
</section><section id="re-model" class="slide level2"><h2>RE model</h2>

<img data-src="meta-analysis-models_files/figure-revealjs/unnamed-chunk-17-1.png" style="width:60.0%" class="r-stretch"></section><section id="re-model-estimation" class="slide level2"><h2>RE model estimation</h2>
<p>Given that we extended the EE model equation. Also the estimation of the average effect need to be extended. Basically the RE is still a weighted average but weights need to include also <span class="math inline">\(\tau^2\)</span>.</p>
<p><span id="eq-re1"><span class="math display">\[
\overline y = \frac{\sum_{i = 1}^k y_iw^*_i}{\sum_{i = 1}^k w^*_i}
\tag{5}\]</span></span></p>
<p><span id="eq-re2"><span class="math display">\[
w^*_i = \frac{1}{\sigma^2_i + \tau^2}
\tag{6}\]</span></span></p>
<p>The weights are different compared to the EE model. Extremely precise/imprecise studies will have less impact in the RE model.</p>
</section><section id="re-vs-ee-model" class="slide level2"><h2>RE vs EE model</h2>
<p>The crucial difference with the EE model is that even with large <span class="math inline">\(n\)</span>, only the <span class="math inline">\(\mu_{\theta} + \delta_i\)</span> are estimated (almost) without error. As long <span class="math inline">\(\tau^2 \neq 0\)</span> there will be variability in the effect sizes.</p>

<img data-src="meta-analysis-models_files/figure-revealjs/unnamed-chunk-18-1.png" width="960" class="r-stretch"></section><section id="simulating-a-re-model" class="slide level2"><h2>Simulating a RE Model</h2>
<p>To simulate the RE model we simply need to include <span class="math inline">\(\tau^2\)</span> in the EE model simulation.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">15</span> <span class="co"># number of studies</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="co"># average effect</span></span>
<span><span class="va">tau2</span> <span class="op">&lt;-</span> <span class="fl">0.1</span> <span class="co"># heterogeneity</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="va">k</span>, <span class="fl">30</span> <span class="op">-</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># sample size</span></span>
<span><span class="va">deltai</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">k</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">tau2</span><span class="op">)</span><span class="op">)</span> <span class="co"># random-effects</span></span>
<span><span class="va">thetai</span> <span class="op">&lt;-</span> <span class="va">mu</span> <span class="op">+</span> <span class="va">deltai</span> <span class="co"># true study effect</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span>k <span class="op">=</span> <span class="va">k</span>, es <span class="op">=</span> <span class="va">thetai</span>, n1 <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  id      yi     vi n1 n2 
1  1  0.4088 0.0522 32 32 
2  2  1.1980 0.0437 39 39 
3  3  0.3510 0.0980 26 26 
4  4 -0.0956 0.0856 24 24 
5  5  0.9501 0.0927 26 26 
6  6 -0.1494 0.0802 34 34 </code></pre>
</div>
</div>
</section><section id="simulating-a-re-model-1" class="slide level2"><h2>Simulating a RE model</h2>
<p>Again, we can put everything within a function expanding the previous <code>sim_studies()</code> by including <span class="math inline">\(\tau^2\)</span>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section><section id="simulating-a-re-model-2" class="slide level2"><h2>Simulating a RE model</h2>
<p>The data are similar to the EE simulation but we have an extra source of heterogeneity.</p>

<img data-src="meta-analysis-models_files/figure-revealjs/unnamed-chunk-21-1.png" width="960" class="r-stretch"></section><section id="simulating-a-re-model-3" class="slide level2"><h2>Simulating a RE model</h2>
<p>To see the actual impact of <span class="math inline">\(\tau^2\)</span> we can follow the same approach of <a href="#/sec-ee-impact-n" class="quarto-xref">Slide&nbsp;3.5</a> thus using a large <span class="math inline">\(n\)</span>. The sampling variance <code>vi</code> of each study is basically 0.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># ... other parameters as before</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1e4</span></span>
<span><span class="va">deltai</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">k</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">tau2</span><span class="op">)</span><span class="op">)</span> <span class="co"># random-effects</span></span>
<span><span class="va">thetai</span> <span class="op">&lt;-</span> <span class="va">mu</span> <span class="op">+</span> <span class="va">deltai</span> <span class="co"># true study effect</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span>k <span class="op">=</span> <span class="va">k</span>, es <span class="op">=</span> <span class="va">thetai</span>, n1 <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span><span class="co"># or equivalently </span></span>
<span><span class="co"># dat &lt;- sim_studies(k = k, es = mu, tau2 = tau2, n1 = n)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  id     yi     vi    n1    n2 
1  1 0.7607 0.0002 10000 10000 
2  2 0.7781 0.0002 10000 10000 
3  3 0.2030 0.0002 10000 10000 
4  4 0.2891 0.0002 10000 10000 
5  5 0.8780 0.0002 10000 10000 
6  6 0.5198 0.0002 10000 10000 </code></pre>
</div>
</div>
</section><section id="simulating-a-re-model-4" class="slide level2"><h2>Simulating a RE Model</h2>
<p>Clearly, compared to <a href="#/sec-ee-impact-n" class="quarto-xref">Slide&nbsp;3.5</a>, even with large <span class="math inline">\(n\)</span> the variability is not reduced because <span class="math inline">\(\tau^2 \neq 0\)</span>. As <span class="math inline">\(\tau^2\)</span> approach zero the EE and RE models are similar.</p>

<img data-src="meta-analysis-models_files/figure-revealjs/unnamed-chunk-23-1.png" width="960" class="r-stretch"></section><section id="re-model-estimation-1" class="slide level2"><h2>RE model estimation</h2>
<p>Given that we extended the EE model equation. Also the estimation of the average effect need to be extended. Basically the RE is still a weighted average but weights need to include also <span class="math inline">\(\tau^2\)</span>.</p>
<p><span id="eq-re1"><span class="math display">\[
\overline y = \frac{\sum_{i = 1}^k y_iw^*_i}{\sum_{i = 1}^k w^*_i}
\tag{7}\]</span></span></p>
<p><span id="eq-re2"><span class="math display">\[
w^*_i = \frac{1}{\sigma^2_i + \tau^2}
\tag{8}\]</span></span></p>
<p>The weights are different compared to the EE model. Extremely precise/imprecise studies will have less impact in the RE model.</p>
</section><section id="fitting-a-re-model" class="slide level2"><h2>Fitting a RE model</h2>
<p>In R we can use the <code><a href="https://wviechtb.github.io/metafor/reference/rma.uni.html">metafor::rma()</a></code> function using the <code>method = "REML"</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Random-Effects Model (k = 15; tau^2 estimator: REML)

  logLik  deviance       AIC       BIC      AICc   
 -1.6196    3.2393    7.2393    8.5174    8.3302   

tau^2 (estimated amount of total heterogeneity): 0.0736 (SE = 0.0279)
tau (square root of estimated tau^2 value):      0.2713
I^2 (total heterogeneity / total variability):   99.73%
H^2 (total variability / sampling variability):  367.76

Test for Heterogeneity:
Q(df = 14) = 5166.5259, p-val &lt; .0001

Model Results:

estimate      se    zval    pval   ci.lb   ci.ub      
  0.5391  0.0701  7.6861  &lt;.0001  0.4016  0.6766  *** 

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section><section id="intepreting-the-re-model" class="slide level2"><h2>Intepreting the RE model</h2>
<p>The model output is quite similar to the EE model and also the intepretation is similar.</p>
<p>The only extra section is <code>tau^2/tau</code> that is the estimation of the between-study heterogeneity.</p>
</section><section id="estimating-tau2" class="slide level2"><h2>Estimating <span class="math inline">\(\tau^2\)</span>
</h2>
<p>We used <code>method = "REML"</code> but there are actually several estimators for <span class="math inline">\(\tau^2\)</span>. <span class="citation" data-cites="Viechtbauer2005-zt">Viechtbauer (<a href="#/references" role="doc-biblioref" onclick="">2005</a>)</span>, <span class="citation" data-cites="Veroniki2016-zs">Veroniki et al. (<a href="#/references" role="doc-biblioref" onclick="">2016</a>)</span> and <span class="citation" data-cites="Brannick2019-hv">Brannick et al. (<a href="#/references" role="doc-biblioref" onclick="">2019</a>)</span> provided a comprehensive overview of different estimators.</p>
<p>iframe hete</p>
</section><section id="estimating-tau2-1" class="slide level2"><h2>Estimating <span class="math inline">\(\tau^2\)</span>
</h2>
<p>The <strong>Restricted Maximum Likelihood</strong> (REML) estimator is considered one of the best. We can compare the results using the <code>all_rma()</code> custom function that tests all the estimators<sup>1</sup>.</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fitl</span> <span class="op">&lt;-</span> <span class="fu">all_rma</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">filor</span><span class="fu">::</span><span class="fu"><a href="https://filippogambarota.github.io/filor/reference/compare_rma.html">compare_rma</a></span><span class="op">(</span>fitlist <span class="op">=</span> <span class="va">fitl</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          DL     HE     HS    HSk     SJ     ML   REML     EB     PM    PMM
b      0.539  0.539  0.539  0.539  0.539  0.539  0.539  0.539  0.539  0.539
se     0.070  0.070  0.068  0.070  0.070  0.068  0.070  0.070  0.070  0.072
zval   7.673  7.686  7.942  7.673  7.687  7.956  7.686  7.686  7.687  7.503
pval   0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000
ci.lb  0.401  0.402  0.406  0.401  0.402  0.406  0.402  0.402  0.402  0.398
ci.ub  0.677  0.677  0.672  0.677  0.677  0.672  0.677  0.677  0.677  0.680
I2    99.729 99.728 99.710 99.729 99.728 99.709 99.728 99.728 99.728 99.741
tau2   0.074  0.074  0.069  0.074  0.074  0.069  0.074  0.074  0.074  0.077</code></pre>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn2"><p>The <code><a href="https://filippogambarota.github.io/filor/reference/compare_rma.html">filor::compare_rma()</a></code> function is similar to the <code><a href="https://rdrr.io/pkg/car/man/compareCoefs.html">car::compareCoefs()</a></code> function</p></li></ol></aside></section><section id="intepreting-heterogeneity-tau2" class="slide level2"><h2>Intepreting heterogeneity <span class="math inline">\(\tau^2\)</span>
</h2>
<p>Looking at <a href="#/random-effects-model-re" class="quarto-xref">Equation&nbsp;4</a>, <span class="math inline">\(\tau^2\)</span> is essentially the variance of the random-effect. This means that we can intepret it as the variability (or the standard deviation) of the true effect size distribution.</p>

<img data-src="meta-analysis-models_files/figure-revealjs/unnamed-chunk-26-1.png" width="960" class="r-stretch"></section><section id="intepreting-tau2" class="slide level2"><h2>Intepreting <span class="math inline">\(\tau^2\)</span>
</h2>
<p>As in the previus plot we can assume <span class="math inline">\(n = \infty\)</span> and generate true effects from <a href="#/random-effects-model-re" class="quarto-xref">Equation&nbsp;4</a>. In this way we understand the impact of assuming (or estimating) a certain <span class="math inline">\(\tau^2\)</span>.</p>
<p>For example, a <span class="math inline">\(\tau = 0.2\)</span> and a <span class="math inline">\(\mu_{\theta} = 0.5\)</span>, 50% of the true effects ranged between:</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">yis</span> <span class="op">&lt;-</span> <span class="va">D</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1e5</span>, <span class="fl">0</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">yis</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      75%       25% 
0.6357387 0.3658013 </code></pre>
</div>
</div>
</section><section id="the-q-statistics" class="slide level2"><h2>The <span class="math inline">\(Q\)</span> Statistics<sup>1</sup>
</h2>
<p>The Q statistics is used to make inference on the heterogeneity. Can be considered as a weighted sum of squares:</p>
<p><span class="math display">\[
Q = \sum^k_{i = 1}w_i(y_i - \hat \mu)^2
\]</span></p>
<p>Where <span class="math inline">\(\hat \mu\)</span> is EE estimation (regardless if <span class="math inline">\(\tau^2 \neq 0\)</span>) and <span class="math inline">\(w_i\)</span> are the inverse-variance weights. Note that in the case of <span class="math inline">\(w_1 = w_2 ... = w_i\)</span>, Q is just a standard sum of squares (or deviance).</p>
<aside><ol class="aside-footnotes"><li id="fn3"><p>See <span class="citation" data-cites="Harrer2021-go">Harrer et al. (<a href="#/references" role="doc-biblioref" onclick="">2021</a>)</span> (Chapter 5) and <span class="citation" data-cites="Hedges2019-ry">Hedges and Schauer (<a href="#/references" role="doc-biblioref" onclick="">2019</a>)</span> for an overview about the Q statistics</p></li></ol></aside></section><section id="the-q-statistics-1" class="slide level2"><h2>The <span class="math inline">\(Q\)</span> Statistics</h2>
<ul>
<li>Given that we are summing up squared distances, they should be approximately <span class="math inline">\(\chi^2\)</span> with <span class="math inline">\(df = k - 1\)</span>. In case of no heterogeneity (<span class="math inline">\(\tau^2 = 0\)</span>) the observed variability is only caused by sampling error and the expectd value of the <span class="math inline">\(\chi^2\)</span> is just the degrees of freedom (<span class="math inline">\(df = k - 1\)</span>).</li>
<li>In case of <span class="math inline">\(\tau^2 \neq 0\)</span>, the expected value is <span class="math inline">\(k - 1 + \lambda\)</span> where <span class="math inline">\(\lambda\)</span> is a non-centrality parameter.</li>
<li>In other terms, if the expected value of <span class="math inline">\(Q\)</span> exceed the expected value assuming no heterogeneity, we have evidence that <span class="math inline">\(\tau^2 \neq 0\)</span>.</li>
</ul></section><section id="the-q-statistics-2" class="slide level2"><h2>The <span class="math inline">\(Q\)</span> Statistics</h2>
<p>Letâs try a more practical approach. We simulate a lot of meta-analysis with and without heterogeneity and we check the Q statistics.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">get_Q</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">wi</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">vi</span></span>
<span>  <span class="va">theta_ee</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/weighted.mean.html">weighted.mean</a></span><span class="op">(</span><span class="va">yi</span>, <span class="va">wi</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">wi</span><span class="op">*</span><span class="op">(</span><span class="va">yi</span> <span class="op">-</span> <span class="va">theta_ee</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">tau2</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="va">nsim</span> <span class="op">&lt;-</span> <span class="fl">1e4</span></span>
<span></span>
<span><span class="va">Qs_tau2_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nsim</span><span class="op">)</span></span>
<span><span class="va">Qs_tau2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nsim</span><span class="op">)</span></span>
<span><span class="va">res2_tau2_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="va">nsim</span><span class="op">)</span></span>
<span><span class="va">res2_tau2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="va">nsim</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nsim</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">dat_tau2_0</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span>k <span class="op">=</span> <span class="fl">30</span>, es <span class="op">=</span> <span class="fl">0.5</span>, tau2 <span class="op">=</span> <span class="fl">0</span>, n1 <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span>  <span class="va">dat_tau2</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span>k <span class="op">=</span> <span class="fl">30</span>, es <span class="op">=</span> <span class="fl">0.5</span>, tau2 <span class="op">=</span> <span class="va">tau2</span>, n1 <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">theta_ee_tau2_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/weighted.mean.html">weighted.mean</a></span><span class="op">(</span><span class="va">dat_tau2_0</span><span class="op">$</span><span class="va">yi</span>, <span class="fl">1</span><span class="op">/</span><span class="va">dat_tau2_0</span><span class="op">$</span><span class="va">vi</span><span class="op">)</span></span>
<span>  <span class="va">theta_ee</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/weighted.mean.html">weighted.mean</a></span><span class="op">(</span><span class="va">dat_tau2</span><span class="op">$</span><span class="va">yi</span>, <span class="fl">1</span><span class="op">/</span><span class="va">dat_tau2</span><span class="op">$</span><span class="va">vi</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">res2_tau2_0</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">dat_tau2_0</span><span class="op">$</span><span class="va">yi</span> <span class="op">-</span> <span class="va">theta_ee_tau2_0</span></span>
<span>  <span class="va">res2_tau2</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">dat_tau2</span><span class="op">$</span><span class="va">yi</span> <span class="op">-</span> <span class="va">theta_ee</span></span>
<span>  </span>
<span>  <span class="va">Qs_tau2_0</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">get_Q</span><span class="op">(</span><span class="va">dat_tau2_0</span><span class="op">$</span><span class="va">yi</span>, <span class="va">dat_tau2_0</span><span class="op">$</span><span class="va">vi</span><span class="op">)</span></span>
<span>  <span class="va">Qs_tau2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">get_Q</span><span class="op">(</span><span class="va">dat_tau2</span><span class="op">$</span><span class="va">yi</span>, <span class="va">dat_tau2</span><span class="op">$</span><span class="va">vi</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>

<img data-src="meta-analysis-models_files/figure-revealjs/unnamed-chunk-29-1.png" width="960" class="r-stretch"></section><section id="the-q-statistics-3" class="slide level2"><h2>The <span class="math inline">\(Q\)</span> Statistics</h2>
<p>Letâs try a more practical approach. We simulate a lot of meta-analysis with and without heterogeneity and we check the Q statistics.</p>
<div class="fragment">
<ul>
<li>clearly, in the presence of heterogeneity, the expected value of the Q statistics is higher (due to <span class="math inline">\(\lambda \neq 0\)</span>) and also residuals are larger (the <span class="math inline">\(\chi^2\)</span> is just a sum of squared weighted residuals)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>we can calculate a p-value for deviation from the <span class="math inline">\(\tau^2 = 0\)</span> case as evidence agaist the absence of heterogeneity</li>
</ul>
</div>
</section><section id="i2-higgins2002-fh" class="slide level2"><h2>
<span class="math inline">\(I^2\)</span> <span class="citation" data-cites="Higgins2002-fh">(<a href="#/references" role="doc-biblioref" onclick="">Higgins and Thompson 2002</a>)</span>
</h2>
<p>We have two sources of variability in a random-effects meta-analysis, the sampling variability <span class="math inline">\(\sigma_i^2\)</span> and true heterogeneity <span class="math inline">\(\tau^2\)</span>. We can use the <span class="math inline">\(I^2\)</span> to express the interplay between the two. <span id="eq-i2"><span class="math display">\[
I^2 = 100\% \times \frac{\hat{\tau}^2}{\hat{\tau}^2 + \tilde{v}}
\tag{9}\]</span></span></p>
<p><span class="math display">\[
\tilde{v} = \frac{(k-1) \sum w_i}{(\sum w_i)^2 - \sum w_i^2},
\]</span></p>
<p>Where <span class="math inline">\(\tilde{v}\)</span> is the typical sampling variability. <span class="math inline">\(I^2\)</span> is intepreted as the proportion of total variability due to real heterogeneity (i.e., <span class="math inline">\(\tau^2\)</span>)</p>
</section><section id="i2-higgins2002-fh-1" class="slide level2"><h2>
<span class="math inline">\(I^2\)</span> <span class="citation" data-cites="Higgins2002-fh">(<a href="#/references" role="doc-biblioref" onclick="">Higgins and Thompson 2002</a>)</span><sup>1</sup>
</h2>
<p>Note that we can have the same <span class="math inline">\(I^2\)</span> in two completely different meta-analysis. An high <span class="math inline">\(I^2\)</span> does not represent high heterogeneity. Letâs assume to have two meta-analysis with <span class="math inline">\(k\)</span> studies and small (<span class="math inline">\(n = 30\)</span>) vs large (<span class="math inline">\(n = 500\)</span>) sample sizes.</p>
<p>Letâs solve <a href="#/i2-higgins2002-fh" class="quarto-xref">Equation&nbsp;9</a> for <span class="math inline">\(\tau^2\)</span> (using <code><a href="https://filippogambarota.github.io/filor/reference/tau2_from_I2.html">filor::tau2_from_I2()</a></code>) and we found that the same <span class="math inline">\(I^2\)</span> can be obtained with two completely different <span class="math inline">\(\tau^2\)</span> values:</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">n_1</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">vi_1</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">n_1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">n_1</span></span>
<span><span class="va">tau2_1</span> <span class="op">&lt;-</span> <span class="fu">filor</span><span class="fu">::</span><span class="fu"><a href="https://filippogambarota.github.io/filor/reference/tau2_from_I2.html">tau2_from_I2</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="va">vi_1</span><span class="op">)</span></span>
<span><span class="va">tau2_1</span></span>
<span><span class="co">## [1] 0.2666667</span></span>
<span></span>
<span><span class="va">n_2</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">vi_2</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">n_2</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">n_2</span></span>
<span><span class="va">tau2_2</span> <span class="op">&lt;-</span> <span class="fu">filor</span><span class="fu">::</span><span class="fu"><a href="https://filippogambarota.github.io/filor/reference/tau2_from_I2.html">tau2_from_I2</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="va">vi_2</span><span class="op">)</span></span>
<span><span class="va">tau2_2</span></span>
<span><span class="co">## [1] 0.016</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside><ol class="aside-footnotes"><li id="fn4"><p>see <a href="https://www.meta-analysis-workshops.com/download/common-mistakes1.pdf">https://www.meta-analysis-workshops.com/download/common-mistakes1.pdf</a></p></li></ol></aside></section><section id="i2-higgins2002-fh-2" class="slide level2"><h2>
<span class="math inline">\(I^2\)</span> <span class="citation" data-cites="Higgins2002-fh">(<a href="#/references" role="doc-biblioref" onclick="">Higgins and Thompson 2002</a>)</span>
</h2>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">n_1</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">vi_1</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">n_1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">n_1</span></span>
<span><span class="va">tau2_1</span> <span class="op">&lt;-</span> <span class="fu">filor</span><span class="fu">::</span><span class="fu"><a href="https://filippogambarota.github.io/filor/reference/tau2_from_I2.html">tau2_from_I2</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="va">vi_1</span><span class="op">)</span></span>
<span><span class="va">tau2_1</span></span>
<span><span class="co">## [1] 0.2666667</span></span>
<span></span>
<span><span class="va">n_2</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">vi_2</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">n_2</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">n_2</span></span>
<span><span class="va">tau2_2</span> <span class="op">&lt;-</span> <span class="fu">filor</span><span class="fu">::</span><span class="fu"><a href="https://filippogambarota.github.io/filor/reference/tau2_from_I2.html">tau2_from_I2</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="va">vi_2</span><span class="op">)</span></span>
<span><span class="va">tau2_2</span></span>
<span><span class="co">## [1] 0.016</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>In other terms, the <span class="math inline">\(I^2\)</span> can be considered a good index of heterogeneity only when the total variance (<span class="math inline">\(\tilde{v} + \tau^2\)</span>) is similar.</p>
</div>
</section><section id="what-about-tildev" class="slide level2"><h2>What about <span class="math inline">\(\tilde{v}\)</span>?</h2>
<p><span class="math inline">\(\tilde{v}\)</span> is considered the âtypicalâ within-study variability (see <a href="https://www.metafor-project.org/doku.php/tips:i2_multilevel_multivariate">https://www.metafor-project.org/doku.php/tips:i2_multilevel_multivariate</a>). There are different estimators but <a href="#/what-about-tildev" class="quarto-xref">Equation&nbsp;10</a> is the most common.</p>
<p><span id="eq-tildev"><span class="math display">\[
\tilde{v} = \frac{(k-1) \sum w_i}{(\sum w_i)^2 - \sum w_i^2}
\tag{10}\]</span></span></p>
</section><section id="what-about-tildev-1" class="slide level2"><h2>What about <span class="math inline">\(\tilde{v}\)</span>?</h2>
<p>In the hypothetical case where <span class="math inline">\(\sigma^2_1 = \dots = \sigma^2_k\)</span>, <span class="math inline">\(\tilde{v}\)</span> is just <span class="math inline">\(\sigma^2\)</span>. This fact is commonly used to calculate the statistical power analytically <span class="citation" data-cites="Borenstein2009-mo">(<a href="#/references" role="doc-biblioref" onclick="">Borenstein et al. 2009, chap. 29</a>)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">vtilde</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">wi</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">wi</span><span class="op">)</span></span>
<span>  <span class="op">(</span><span class="va">k</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">wi</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">wi</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">wi</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span></span>
<span><span class="co"># same vi</span></span>
<span><span class="va">vi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">30</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="fl">30</span><span class="op">)</span>, <span class="va">k</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">vi</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.06666667 0.06666667 0.06666667 0.06666667 0.06666667 0.06666667</code></pre>
</div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">vtilde</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">vi</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.06666667</code></pre>
</div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># heterogeneous vi</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="va">k</span>, <span class="fl">30</span> <span class="op">-</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">vi</span> <span class="op">&lt;-</span> <span class="fu">sim_vi</span><span class="op">(</span>k <span class="op">=</span> <span class="va">k</span>, n1 <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span><span class="fu">vtilde</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">vi</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.06889391</code></pre>
</div>
</div>
</section><section id="what-about-tildev-2" class="slide level2"><h2>What about <span class="math inline">\(\tilde{v}\)</span>?</h2>
<p>Using simulations we can see that <span class="math inline">\(\tilde{v}\)</span> with heterogenenous variances (i.e., sample sizes in this case) can be approximated by the central tendency of the sample size distribution. Note that we are fixing <span class="math inline">\(\sigma^2 = 1\)</span> thus we are not including uncertainty.</p>

<img data-src="meta-analysis-models_files/figure-revealjs/unnamed-chunk-34-1.png" width="960" class="r-stretch"></section><section id="h2" class="slide level2"><h2><span class="math inline">\(H^2\)</span></h2>
<p>The <span class="math inline">\(H^2\)</span> is an alternative index of heterogeneity. Is calculated as:</p>
<p><span class="math display">\[
H^2 = \frac{Q}{k - 1}
\]</span></p>
<p>We defined <span class="math inline">\(Q\)</span> as the weighted sum of squares representing the total variability. <span class="math inline">\(k - 1\)</span> is the expected value of the <span class="math inline">\(\chi^2\)</span> statistics (i.e., sum of squares) when <span class="math inline">\(\tau^2 = 0\)</span> (or <span class="math inline">\(\lambda = 0\)</span>).</p>
<p>Thus <span class="math inline">\(H^2\)</span> is the ratio between total heterogeneity and sampling variability. Higher <span class="math inline">\(H^2\)</span> is associated with higher heterogeneity <strong>relative</strong> to the sampling variability. <span class="math inline">\(H^2\)</span> is not a measure of absolute heterogeneity.</p>
</section><section id="h2-1" class="slide level2"><h2><span class="math inline">\(H^2\)</span></h2>
<p>When we are fitting a RE model, the <span class="math inline">\(I^2\)</span> and <span class="math inline">\(H^2\)</span> equations are slightly different <span class="citation" data-cites="Higgins2002-fh">(<a href="#/references" role="doc-biblioref" onclick="">Higgins and Thompson 2002</a>)</span><sup>1</sup>.</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">tau2</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span>k <span class="op">=</span> <span class="va">k</span>, es <span class="op">=</span> <span class="va">mu</span>, tau2 <span class="op">=</span> <span class="va">tau2</span>, n1 <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span><span class="va">fit_re</span> <span class="op">&lt;-</span> <span class="fu">rma</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data <span class="op">=</span> <span class="va">dat</span>, method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span>
<span><span class="va">fit_ee</span> <span class="op">&lt;-</span> <span class="fu">rma</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data <span class="op">=</span> <span class="va">dat</span>, method <span class="op">=</span> <span class="st">"EE"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># H2 with EE model</span></span>
<span></span>
<span><span class="va">theta_ee</span> <span class="op">&lt;-</span> <span class="va">fit_ee</span><span class="op">$</span><span class="va">b</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="co"># weighted.mean(dat$yi, 1/dat$vi)</span></span>
<span><span class="va">wi</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">dat</span><span class="op">$</span><span class="va">vi</span></span>
<span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">vi</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">yi</span> <span class="op">-</span> <span class="va">theta_ee</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Q</span>, <span class="va">fit_ee</span><span class="op">$</span><span class="va">QE</span><span class="op">)</span> <span class="co"># same</span></span>
<span><span class="co">## [1] 297.7552 297.7552</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>H2 <span class="op">=</span> <span class="va">fit_ee</span><span class="op">$</span><span class="va">QE</span> <span class="op">/</span> <span class="op">(</span><span class="va">fit_ee</span><span class="op">$</span><span class="va">k</span> <span class="op">-</span> <span class="va">fit_ee</span><span class="op">$</span><span class="va">p</span><span class="op">)</span>, H2_model <span class="op">=</span> <span class="va">fit_ee</span><span class="op">$</span><span class="va">H2</span><span class="op">)</span> <span class="co"># same</span></span>
<span><span class="co">##       H2 H2_model </span></span>
<span><span class="co">## 3.007628 3.007628</span></span>
<span></span>
<span><span class="co"># H2 with RE model</span></span>
<span></span>
<span><span class="va">vt</span> <span class="op">&lt;-</span> <span class="fu">vtilde</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">dat</span><span class="op">$</span><span class="va">vi</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>H2 <span class="op">=</span> <span class="va">fit_re</span><span class="op">$</span><span class="va">tau2</span> <span class="op">/</span> <span class="va">vt</span> <span class="op">+</span> <span class="fl">1</span>, H2_model <span class="op">=</span> <span class="va">fit_re</span><span class="op">$</span><span class="va">H2</span><span class="op">)</span> <span class="co"># same</span></span>
<span><span class="co">##       H2 H2_model </span></span>
<span><span class="co">## 2.985647 2.985647</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside><ol class="aside-footnotes"><li id="fn5"><p>see also the <code>metafor</code> source code https://github.com/cran/metafor/blob/994d26a65455fac90760ad6a004ec1eaca5856b1/R/rma.uni.r#L2459C30-L2459C30</p></li></ol></aside></section><section id="confidence-intervals" class="slide level2"><h2>Confidence Intervals</h2>
<p>What is reported in the model summary as <code>ci.lb</code> and <code>ci.ub</code> refers to the 95% confidence interval representing the uncertainty in estimating the effect (or a meta-regression parameter).</p>
<p>Without looking at the equations, letâs try to implement this idea using simulations.</p>
<ul>
<li>choose <span class="math inline">\(k\)</span>, <span class="math inline">\(\tau^2\)</span> and <span class="math inline">\(n\)</span>
</li>
<li>simulate data (several times) accordingly and fit the RE model</li>
<li>extract the estimated effect size</li>
<li>compare the simulated sampling distribution with the analytical result</li>
</ul></section><section id="confidence-intervals-1" class="slide level2"><h2>Confidence Intervals</h2>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">tau2</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">nsim</span> <span class="op">&lt;-</span> <span class="fl">5e3</span></span>
<span></span>
<span><span class="co"># true parameters (see Borenstein, 2009; Chapter 29)</span></span>
<span><span class="va">vt</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="va">n</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">n</span></span>
<span><span class="va">vs</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">vt</span> <span class="op">+</span> <span class="va">tau2</span><span class="op">)</span><span class="op">/</span> <span class="va">k</span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">vs</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">nsim</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nsim</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span>k <span class="op">=</span> <span class="va">k</span>, es <span class="op">=</span> <span class="va">mu</span>, tau2 <span class="op">=</span> <span class="va">tau2</span>, n1 <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">rma</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span>  <span class="va">mui</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># standard error</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>simulated <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">mui</span><span class="op">)</span>, analytical <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">se</span><span class="op">)</span></span>
<span><span class="co">##  simulated analytical </span></span>
<span><span class="co">## 0.06256399 0.05778470</span></span>
<span></span>
<span><span class="co"># confidence interval</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span></span>
<span>  <span class="st">"simulated"</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">mui</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="st">"analytical"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2.5%"</span> <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">ci.lb</span>, <span class="st">"97.5%"</span> <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">ci.ub</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">##                   5%     97.5%</span></span>
<span><span class="co">## simulated  0.3975505 0.6234262</span></span>
<span><span class="co">## analytical 0.3834089 0.6099208</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="confidence-intervals-2" class="slide level2"><h2>Confidence Intervals</h2>

<img data-src="meta-analysis-models_files/figure-revealjs/unnamed-chunk-37-1.png" width="960" class="r-stretch"></section><section id="confidence-intervals-3" class="slide level2"><h2>Confidence Intervals</h2>
<p>Now the equation for the 95% confidence interval should be more clear. The standard error is a function of the within study sampling variances (depending mainly on <span class="math inline">\(n\)</span>), <span class="math inline">\(\tau^2\)</span> and <span class="math inline">\(k\)</span>. As we increase <span class="math inline">\(k\)</span> the standard error tends towards zero.</p>
<p><span class="math display">\[
CI = \hat \mu_{\theta} \pm z SE_{\mu_{\theta}}
\]</span></p>
<p><span class="math display">\[
SE_{\mu_{\theta}} = \sqrt{\frac{1}{\sum^{k}_{i = 1}w^{\star}_i}}
\]</span></p>
<p><span class="math display">\[
w^{\star}_i = \frac{1}{\sigma^2_i + \tau^2}
\]</span></p>
</section><section id="confidence-intervals-4" class="slide level2"><h2>Confidence Intervals</h2>
<p>We can also see it analytically, there is a huge impact of <span class="math inline">\(k\)</span>.</p>

<img data-src="meta-analysis-models_files/figure-revealjs/unnamed-chunk-38-1.png" width="960" class="r-stretch"></section><section id="prediction-intervals-pi" class="slide level2"><h2>Prediction intervals (PI)</h2>
<p>We could say that the CI is not completely taking into account the between-study heterogeneity (<span class="math inline">\(\tau^2\)</span>). After a meta-analysis we would like to know how confident we are in the parameters estimation BUT also <strong>what would be the expected effect running a new experiment tomorrow?</strong>.</p>
<p>The <strong>prediction interval</strong> <span class="citation" data-cites="IntHout2016-sz Riley2011-hp">(<a href="#/references" role="doc-biblioref" onclick="">IntHout et al. 2016</a>; <a href="#/references" role="doc-biblioref" onclick="">Riley, Higgins, and Deeks 2011</a>)</span> is exactly the range of effects that I expect in predicting a new study.</p>
</section><section id="pi-for-a-sample-mean" class="slide level2"><h2>PI for a sample mean</h2>
<p>To understand the concept, letâs assume to have a sample <span class="math inline">\(X\)</span> of size <span class="math inline">\(n\)</span> and we estimate the mean <span class="math inline">\(\overline X\)</span>. The PI is calculated as<sup>1</sup>:</p>
<p><span class="math display">\[
PI = \overline X \pm t_{\alpha/2} s_x \sqrt{1 + \frac{1}{n}}
\]</span></p>
<p>Where <span class="math inline">\(s\)</span> is the sample standard deviation. Basically we are combining the uncertainty in estimating <span class="math inline">\(\overline X\)</span> (i.e, <span class="math inline">\(\frac{s_x}{n}\)</span>) with the standard deviation of the data <span class="math inline">\(s_x\)</span>. Compare it with the confidence interval containing only <span class="math inline">\(\frac{s_x}{n}\)</span>.</p>
<aside><ol class="aside-footnotes"><li id="fn6"><p>Notice that the equation, in particular the usage of <span class="math inline">\(t\)</span> vs <span class="math inline">\(z\)</span> depends on assuming <span class="math inline">\(s_x\)</span> to be known or estimated. See <a href="https://online.stat.psu.edu/stat501/lesson/3/3.3">https://online.stat.psu.edu/stat501/lesson/3/3.3</a>, <a href="https://en.wikipedia.org/wiki/Prediction_interval">https://en.wikipedia.org/wiki/Prediction_interval</a> and <a href="https://www.bryanshalloway.com/2021/03/18/intuition-on-uncertainty-of-predictions-introduction-to-prediction-intervals/">https://www.bryanshalloway.com/2021/03/18/intuition-on-uncertainty-of-predictions-introduction-to-prediction-intervals/</a></p></li></ol></aside></section><section id="pi-in-meta-analysis" class="slide level2"><h2>PI in meta-analysis</h2>
<p>For meta-analysis the equation<sup>1</sup> is conceptually similar but with different quantities.</p>
<p><span class="math display">\[
PI = \hat \mu_{\theta} \pm z \sqrt{\tau^2 + SE_{\mu_{\theta}}}
\]</span></p>
<p>Basically we are combining all the sources of uncertainty. As long as <span class="math inline">\(\tau^2 \neq 0\)</span> the PI is greater than the CI (in the EE model they are the same). Thus even with very precise <span class="math inline">\(\mu_{\theta}\)</span> estimation, large <span class="math inline">\(\tau^2\)</span> leads to uncertain predictions.</p>
<aside><ol class="aside-footnotes"><li id="fn7"><p>When a <span class="math inline">\(t\)</span> distribution is assumed, the quantiles are calculated using <span class="math inline">\(k - 2\)</span> degrees of freedom</p></li></ol></aside></section><section id="pi-in-meta-analysis-1" class="slide level2"><h2>PI in meta-analysis</h2>
<p>In R the PI can be calculated using <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code>. By default the model assume a standard normal distribution thus using <span class="math inline">\(z\)</span> scores. To use the <span class="citation" data-cites="Riley2011-hp">Riley, Higgins, and Deeks (<a href="#/references" role="doc-biblioref" onclick="">2011</a>)</span> approach (<span class="math inline">\(t\)</span> distribution) the model need to be fitted using <code>test = "t"</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">sim_studies</span><span class="op">(</span>k <span class="op">=</span> <span class="va">k</span>, es <span class="op">=</span> <span class="fl">0.5</span>, tau2 <span class="op">=</span> <span class="fl">0.1</span>, n1 <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">fit_z</span> <span class="op">&lt;-</span> <span class="fu">rma</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data <span class="op">=</span> <span class="va">dat</span>, test <span class="op">=</span> <span class="st">"z"</span><span class="op">)</span> <span class="co"># test = "z" is the default</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit_z</span><span class="op">)</span> <span class="co"># notice pi.ub/pi.lb vs ci.ub/ci.lb</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   pred     se  ci.lb  ci.ub   pi.lb  pi.ub 
 0.5109 0.0415 0.4295 0.5923 -0.1369 1.1588 </code></pre>
</div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># manually</span></span>
<span><span class="va">fit_z</span><span class="op">$</span><span class="va">b</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">fit_z</span><span class="op">$</span><span class="va">se</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">fit_z</span><span class="op">$</span><span class="va">tau2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.1369432  1.1587503</code></pre>
</div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_t</span> <span class="op">&lt;-</span> <span class="fu">rma</span><span class="op">(</span><span class="va">yi</span>, <span class="va">vi</span>, data <span class="op">=</span> <span class="va">dat</span>, test <span class="op">=</span> <span class="st">"t"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit_t</span><span class="op">)</span> <span class="co"># notice pi.ub/pi.lb vs ci.ub/ci.lb</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   pred     se  ci.lb  ci.ub   pi.lb  pi.ub 
 0.5109 0.0415 0.4285 0.5933 -0.1450 1.1668 </code></pre>
</div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># manually</span></span>
<span><span class="va">fit_z</span><span class="op">$</span><span class="va">b</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span>, <span class="va">k</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">fit_t</span><span class="op">$</span><span class="va">se</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">fit_t</span><span class="op">$</span><span class="va">tau2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.1450426  1.1668497</code></pre>
</div>
</div>
</section><section id="references" class="slide level2 smaller scrollable"><h2>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Borenstein2009-mo" class="csl-entry" role="listitem">
Borenstein, Michael, Larry V Hedges, Julian P T Higgins, and Hannah R Rothstein. 2009. <span>âIntroduction to <span>Meta-Analysis</span>.â</span> <a href="https://doi.org/10.1002/9780470743386">https://doi.org/10.1002/9780470743386</a>.
</div>
<div id="ref-Brannick2019-hv" class="csl-entry" role="listitem">
Brannick, Michael T, Sean M Potter, Bryan Benitez, and Scott B Morris. 2019. <span>âBias and Precision of Alternate Estimators in Meta-Analysis: Benefits of Blending Schmidt-Hunter and Hedges Approaches.â</span> <em>Organizational Research Methods</em> 22 (April): 490â514. <a href="https://doi.org/10.1177/1094428117741966">https://doi.org/10.1177/1094428117741966</a>.
</div>
<div id="ref-Gambarota2023-on" class="csl-entry" role="listitem">
Gambarota, Filippo, and Gianmarco AltoÃ¨. 2023. <span>âUnderstanding Meta-Analysis Through Data Simulation with Applications to Power Analysis.â</span> <em>Advances in Methods and Practices in Psychological Science</em>, March. <a href="https://doi.org/10.1177/25152459231209330">https://doi.org/10.1177/25152459231209330</a>.
</div>
<div id="ref-Harrer2021-go" class="csl-entry" role="listitem">
Harrer, Mathias, Pim Cuijpers, Toshi Furukawa, and David Ebert. 2021. <em>Doing Meta-Analysis with r: A Hands-on Guide</em>. 1st ed. London, England: CRC Press.
</div>
<div id="ref-Hedges2019-ry" class="csl-entry" role="listitem">
Hedges, Larry V, and Jacob M Schauer. 2019. <span>âStatistical Analyses for Studying Replication: Meta-Analytic Perspectives.â</span> <em>Psychological Methods</em> 24 (October): 557â70. <a href="https://doi.org/10.1037/met0000189">https://doi.org/10.1037/met0000189</a>.
</div>
<div id="ref-Higgins2002-fh" class="csl-entry" role="listitem">
Higgins, Julian P T, and Simon G Thompson. 2002. <span>âQuantifying Heterogeneity in a Meta-Analysis.â</span> <em>Statistics in Medicine</em> 21 (June): 1539â58. <a href="https://doi.org/10.1002/sim.1186">https://doi.org/10.1002/sim.1186</a>.
</div>
<div id="ref-IntHout2016-sz" class="csl-entry" role="listitem">
IntHout, Joanna, John P A Ioannidis, Maroeska M Rovers, and Jelle J Goeman. 2016. <span>âPlea for Routinely Presenting Prediction Intervals in Meta-Analysis.â</span> <em>BMJ Open</em> 6 (July): e010247. <a href="https://doi.org/10.1136/bmjopen-2015-010247">https://doi.org/10.1136/bmjopen-2015-010247</a>.
</div>
<div id="ref-Riley2011-hp" class="csl-entry" role="listitem">
Riley, Richard D, Julian P T Higgins, and Jonathan J Deeks. 2011. <span>âInterpretation of Random Effects Meta-Analyses.â</span> <em>BMJ</em> 342 (February): d549. <a href="https://doi.org/10.1136/bmj.d549">https://doi.org/10.1136/bmj.d549</a>.
</div>
<div id="ref-Veroniki2016-zs" class="csl-entry" role="listitem">
Veroniki, Areti Angeliki, Dan Jackson, Wolfgang Viechtbauer, Ralf Bender, Jack Bowden, Guido Knapp, Oliver Kuss, Julian P T Higgins, Dean Langan, and Georgia Salanti. 2016. <span>âMethods to Estimate the Between-Study Variance and Its Uncertainty in Meta-Analysis.â</span> <em>Research Synthesis Methods</em> 7 (March): 55â79. <a href="https://doi.org/10.1002/jrsm.1164">https://doi.org/10.1002/jrsm.1164</a>.
</div>
<div id="ref-Viechtbauer2005-zt" class="csl-entry" role="listitem">
Viechtbauer, Wolfgang. 2005. <span>âBias and Efficiency of Meta-Analytic Variance Estimators in the Random-Effects Model.â</span> <em>Journal of Educational and Behavioral Statistics: A Quarterly Publication Sponsored by the American Educational Research Association and the American Statistical Association</em> 30 (September): 261â93. <a href="https://doi.org/10.3102/10769986030003261">https://doi.org/10.3102/10769986030003261</a>.
</div>
</div>


</section><div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div></section><!-- FINAL SLIDE --><!-- END FINAL SLIDE -->
</div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="../../site_libs/revealjs/dist/reveal.js"></script><!-- reveal.js plugins --><script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script><script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script><script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script><script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script><script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script><script src="../../site_libs/revealjs/plugin/notes/notes.js"></script><script src="../../site_libs/revealjs/plugin/search/search.js"></script><script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script><script src="../../site_libs/revealjs/plugin/math/math.js"></script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script><script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script><script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>


</body></html>