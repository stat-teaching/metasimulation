{
  "hash": "d1de9052027841c65a3b8d594394ae0f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Meta-analysis Models\n---\n\n\n\n\n\n\n# Simulation setup {.section}\n\n## Notation {.smaller}\n\nMeta-analysis notation is a little bit inconsistent in textbooks and papers. We define here some rules to simplify the work.\n\n- $k$ is the number of studies\n- $n_j$ is the sample size of the group $j$ within a study\n- $y_i$ are the observed effect size included in the meta-analysis\n- $\\sigma_i^2$ are the observed sampling variance of studies and $\\epsilon_i$ are the sampling errors\n- $\\theta$ is the equal-effects parameter (see @eq-ee1)\n- $\\delta_i$ is the random-effect (see @eq-re-mod2)\n- $\\mu_\\theta$ is the average effect of a random-effects model (see @eq-re-mod1)\n- $w_i$ are the meta-analysis weights\n- $\\tau^2$ is the heterogeneity (see @eq-re-mod2)\n- $\\Delta$ is the (generic) population effect size\n- $s_j^2$ is the variance of the group $j$ within a study\n\n## Simulation setup\n\nGiven the introduction to effect sizes, from now we will simulate data using UMD and the individual-level data. \n\nBasically we are simulating an effect size $D$ coming from the comparison of two independent groups $G_1$ and $G_2$.\n\nEach group is composed by $n$ participants measured on a numerical outcome (e.g., reaction times)\n\n## Simulation setup\n\nA more general, clear and realistic approach to simulate data is by generating $k$ studies with same/different sample sizes and (later) true effect sizes.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nk <- 10 # number of studies\nn1 <- n2 <- 10 + rpois(k, 30 - 10) # sample size from poisson distribution with lambda 40 and minimum 10\nD <- 0.5 # effect size\n\nyi <- rep(NA, k)\nvi <- rep(NA, k)\n  \nfor(i in 1:k){\n  g1 <- rnorm(n1[i], 0, 1)\n  g2 <- rnorm(n2[i], D, 1)\n  yi[i] <- mean(g2) - mean(g1)\n  vi[i] <- var(g1)/n1[i] + var(g2)/n2[i]\n}\n  \nsim <- data.frame(id = 1:k, yi, vi)\n\nhead(sim)\n#>   id         yi         vi\n#> 1  1 -0.1496544 0.05107643\n#> 2  2  0.3928153 0.06931350\n#> 3  3  0.4329961 0.06748458\n#> 4  4 -0.2228198 0.05229323\n#> 5  5  0.4429819 0.09635554\n#> 6  6  0.5240306 0.08061976\n```\n:::\n\n\n## Simulation setup\n\nWe can again put everything within a function:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsim_studies <- function(k, es, n1, n2 = NULL){\n  if(length(n1) == 1) n1 <- rep(n1, k)\n  if(is.null(n2)) n2 <- n1\n  if(length(es) == 1) es <- rep(es, k)\n  \n  yi <- rep(NA, k)\n  vi <- rep(NA, k)\n  \n  for(i in 1:k){\n    g1 <- rnorm(n1[i], 0, 1)\n    g2 <- rnorm(n2[i], es[i], 1)\n    yi[i] <- mean(g2) - mean(g1)\n    vi[i] <- var(g1)/n1[i] + var(g2)/n2[i]\n  }\n  \n  sim <- data.frame(id = 1:k, yi, vi, n1 = n1, n2 = n2)\n  \n  # convert to escalc for using metafor methods\n  sim <- metafor::escalc(yi = yi, vi = vi, data = sim)\n  \n  return(sim)\n}\n```\n:::\n\n\n## Simulation setup - Disclaimer\n\nThe proposed simulation approach using a `for` loop and separated vectors. For the purpose of the workshop this is the best option. In real-world meta-analysis simulations you can choose a more functional approach starting from a simulation grid as `data.frame` and mapping the simulation functions.\n\nFor some examples see:\n\n- @Gambarota2023-on\n- [www.jepusto.com/simulating-correlated-smds](https://www.jepusto.com/simulating-correlated-smds)\n\n## Simulation setup - Disclaimer\n\nFor a more extended overview of the simulation setup we have an entire paper. Supplementary materials ([github.com/shared-research/simulating-meta-analysis](https://github.com/shared-research/simulating-meta-analysis)) contains also more examples for complex (multilevel and multivariate models.)\n\n![](img/gambarota2023.png){fig-align=\"center\"}\n\n# Combining studies {.section}\n\n## Combining studies\n\nLet's imagine to have $k = 10$ studies, a $D = 0.5$ and heterogeneous sample sizes in each study.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nk <- 10\nD <- 0.5\nn <- 10 + rpois(k, lambda = 20) \ndat <- sim_studies(k = k, es = D, n1 = n)\nhead(dat)\n#> \n#>   id     yi     vi n1 n2 \n#> 1  1 0.3030 0.0528 35 35 \n#> 2  2 0.4969 0.0851 28 28 \n#> 3  3 0.5364 0.0650 32 32 \n#> 4  4 0.0415 0.0808 23 23 \n#> 5  5 0.8634 0.0841 30 30 \n#> 6  6 0.9129 0.0443 32 32\n```\n:::\n\n\n. . .\n\nWhat is the best way to combine the studies?\n\n## Combining studies\n\nWe can take the average effect size and considering it as a huge study. This can be considered the best way to combine the effects.\n\n$$\n\\hat{D} = \\frac{\\sum^{k}_{i = 1} D_i}{k}\n$$\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmean(dat$yi)\n#> [1] 0.5150518\n```\n:::\n\n\n. . .\n\nIt is appropriate? What do you think? Are we missing something?\n\n## Weighting studies\n\nWe are not considering that some studies, despite providing a similar effect size could give more information. An higher sample size (or lower sampling variance) produce a more reliable estimation.\n\n. . .\n\nWould you trust more a study with $n = 100$ and $D = 0.5$ or a study with $n = 10$ and $D = 0.5$? The \"meta-analysis\" that we did before is completely ignoring this information.\n\n## Weighting studies\n\nWe need to find a value (called weight $w_i$) that allows assigning more trust to a study because it provide more information. \n\n. . .\n\nThe simplest weights are just the sample size, but in practice we use the so-called **inverse-variance weighting**. We use the (inverse) of the sampling variance of the effect size to weight each study. \n\n. . .\n\nThe basic version of a meta-analysis is just a **weighted average**:\n\n$$\n\\overline D_w = \\frac{\\sum^k_{i = 1}{w_iD_i}}{\\sum^k_{i = 1}{w_i}}\n$$\n\n. . .\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nwi <- 1/dat$vi\nsum(dat$yi * wi) / sum(wi)\n#> [1] 0.5350624\n# weighted.mean(dat$yi, wi)\n```\n:::\n\n\n## Weighting studies\n\nGraphically, the two models can be represented in this way:\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](meta-analysis-models_files/figure-revealjs/unnamed-chunk-8-1.svg){fig-align='center' width=960}\n:::\n:::\n\n\n# Equal-effects (EE) meta-analysis {.section}\n\n## EE meta-analysis\n\nWhat we did in the last example (the weighted mean) is the exactly a meta-analysis model called **equal-effects** (or less precisely fixed-effect). The assumptions are very simple:\n\n- there is a unique, true effect size to estimate $\\theta$\n- each study is a more or less precise estimate of $\\theta$\n- there is no TRUE variability among studies. The observed variability is due to studies that are imprecise (i.e., sampling error)\n- assuming that each study has a very large sample size, the observed variability is close to zero.\n\n## EE meta-analysis, formally\n\n$$\ny_i = \\theta + \\epsilon_i\n$$ {#eq-ee1}\n\n$$\n\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2_i)\n$$ {#eq-ee2}\n\nWhere $\\sigma^2_i$ is the vector of sampling variabilities of $k$ studies. This is a standard linear model but with heterogeneous sampling variances.\n\n## EE meta-analysis\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](meta-analysis-models_files/figure-revealjs/unnamed-chunk-9-1.svg){fig-align='center' width=960}\n:::\n:::\n\n\n## Simulating an EE model\n\nWhat we were doing with the `sim_studies()` function so far was simulating an EE model. In fact, there were a single $\\theta$ parameter and the observed variability was a function of the `rnorm()` randomness.\n\nBased on previous assumptions and thinking a little bit, what could be the result of simulating studies with a very large $n$?\n\n. . .\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nns <- c(10, 50, 100, 1000, 1e4)\nD <- 0.5\ndats <- lapply(ns, function(n) sim_studies(10, es = D, n1 = n))\n```\n:::\n\n\n## Simulating an EE modelm {#sec-ee-impact-n}\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](meta-analysis-models_files/figure-revealjs/unnamed-chunk-11-1.svg){fig-align='center' width=1440}\n:::\n:::\n\n\n## Simulating an EE model\n\nFormulating the model as a intercept-only regression (see Equations [@eq-ee1] and [@eq-ee2]) we can generate data directly:\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\nAs we did for the aggregated data approach. Clearly we need to simulate also the `vi` vector from the appropriate distribution. Given that we simulated data starting from the participant-level the uncertainty of `yi` and `vi` is already included.\n\n## Fitting an EE model\n\nThe model can be fitted using the `metafor::rma()` function, with `method = \"EE\"`^[There is a confusion about the *fixed-effects* vs *fixed-effect* (no *s*) and *equal-effects* models. See [https://wviechtb.github.io/metafor/reference/misc-models.html](https://wviechtb.github.io/metafor/reference/misc-models.html)].\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntheta <- 0.5\nk <- 15\nn <- 10 + rpois(k, 30 - 10)\ndat <- sim_studies(k = k, es = theta, n1 = n)\nfit <- rma(yi, vi, data = dat, method = \"EE\")\nsummary(fit)\n#> \n#> Equal-Effects Model (k = 15)\n#> \n#>   logLik  deviance       AIC       BIC      AICc   \n#>  -6.1237   26.4850   14.2475   14.9555   14.5552   \n#> \n#> I^2 (total heterogeneity / total variability):   47.14%\n#> H^2 (total variability / sampling variability):  1.89\n#> \n#> Test for Heterogeneity:\n#> Q(df = 14) = 26.4850, p-val = 0.0224\n#> \n#> Model Results:\n#> \n#> estimate      se    zval    pval   ci.lb   ci.ub      \n#>   0.5037  0.0635  7.9359  <.0001  0.3793  0.6281  *** \n#> \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n\n## Interpreting an EE model\n\n- The first section (`logLik`, `deviance`, etc.) presents some general model statistics and information criteria\n- The $I^2$ and $H^2$ are statistics evaluating the observed heterogeneity (see next slides)\n- The `Test of Heterogeneity` section presents the test of the $Q$ statistics for the observed heterogeneity (see next slides)\n- The `Model Results` section presents the estimation of the $\\theta$ parameter along with the standard error and the Wald $z$ test ($H_0: \\theta = 0$)\n\nThe `metafor` package has a several well documented functions to calculate and plot model results, residuals analysis etc.\n\n## Interpreting an EE model\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot(fit) # general plots\n```\n\n::: {.cell-output-display}\n![](meta-analysis-models_files/figure-revealjs/unnamed-chunk-14-1.svg){fig-align='center' width=960}\n:::\n:::\n\n\n## Interpreting an EE Model\n\nThe main function for plotting model results is the `forest()` function that produce the forest plot.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nforest(fit)\n```\n\n::: {.cell-output-display}\n![](meta-analysis-models_files/figure-revealjs/unnamed-chunk-15-1.svg){fig-align='center' width=960}\n:::\n:::\n\n\n## Interpreting an EE Model\n\nWe did not introduced the concept of heterogeneity, but the $I^2$, $H^2$ and $Q$ statistics basically evaluate if the observed heterogeneity should be attributed to **sampling variability** (uncertainty in estimating $\\theta$ because we have a limited $k$ and $n$) or **sampling variability** plus other sources of heterogeneity.\n\n## EE model as a weighted Average\n\nFormally $\\theta$ is estimated as [see @Borenstein2009-mo, p. 66]\n\n$$\n\\hat{\\theta} = \\frac{\\sum^k_{i = 1}{w_iy_i}}{\\sum^k_{i = 1}{w_i}}; \\;\\;\\; w_i = \\frac{1}{\\sigma^2_i}\n$$\n\n$$\nSE_{\\theta} = \\frac{1}{\\sum^k_{i = 1}{w_i}}\n$$\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nwi <- 1/dat$vi\ntheta_hat <- with(dat, sum(yi * wi)/sum(wi))\nse_theta_hat <- sqrt(1/sum(wi))\nc(theta = theta_hat, se = se_theta_hat, z = theta_hat / se_theta_hat)\n#>      theta         se          z \n#> 0.50367953 0.06346824 7.93592975\n```\n:::\n\n\n# Random-effects (RE) meta-analysis {.section}\n\n## Are the EE assumptions realistic?\n\nThe EE model is appropriate if our studies are somehow **exact replications** of the exact same effect. We are assuming that there is **no real variability**.\n\n. . .\n\nHowever, meta-analysis rarely report the results of $k$ exact replicates. It is more common to include **studies answering the same research question** but with different methods, participants, etc.\n\n. . .\n\n- people with different ages or other participant-level differences\n- different methodology\n- ...\n\n## Are the EE assumptions realistic?\n\n. . .\n\nIf we relax the previous assumption we are able to combine studies that are not exact replications. \n\n. . .\n\nThus the real effect $\\theta$ is no longer a single **true** value but can be larger or smaller in some conditions.\n\n. . .\n\nIn other terms we are assuming that there could be some variability (i.e., **heterogeneity**) among studies that is independent from the sample size. Even with studies with $\\lim_{n\\to\\infty}$ the observed variability is not zero.\n\n## Random-effects model (RE)\n\nWe can extend the EE model including another source of variability, $\\tau^2$. $\\tau^2$ is the true heterogeneity among studies caused by methdological differences or intrisic variability in the phenomenon.\n\nFormally we can extend @eq-ee1 as:\n$$\ny_i = \\mu_{\\theta} + \\delta_i + \\epsilon_i\n$$ {#eq-re-mod1}\n\n$$\n\\delta_i \\sim \\mathcal{N}(0, \\tau^2)\n$$ {#eq-re-mod2}\n\n$$\n\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2_i)\n$$\n\nWhere $\\mu_{\\theta}$ is the average effect size and $\\delta_i$ is the study-specific deviation from the average effect (regulated by $\\tau^2$). Clearly each study specific effect is $\\theta_i = \\mu_{\\theta} + \\delta_i$.\n\n## RE model\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](meta-analysis-models_files/figure-revealjs/unnamed-chunk-17-1.svg){fig-align='center' width=60%}\n:::\n:::\n\n\n## RE model estimation\n\nGiven that we extended the EE model equation. Also the estimation of the average effect need to be extended. Basically the RE is still a weighted average but weights need to include also $\\tau^2$.\n\n$$\n\\overline y = \\frac{\\sum_{i = 1}^k y_iw^*_i}{\\sum_{i = 1}^k w^*_i}\n$$ {#eq-re1}\n\n$$\nw^*_i = \\frac{1}{\\sigma^2_i + \\tau^2}\n$$ {#eq-re2}\n\nThe weights are different compared to the EE model. Extremely precise/imprecise studies will have less impact in the RE model.\n\n## RE vs EE model\n\nThe crucial difference with the EE model is that even with large $n$, only the $\\mu_{\\theta} + \\delta_i$ are estimated (almost) without error. As long $\\tau^2 \\neq 0$ there will be variability in the effect sizes.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](meta-analysis-models_files/figure-revealjs/unnamed-chunk-18-1.svg){fig-align='center' width=960}\n:::\n:::\n\n\n## Simulating a RE Model\n\nTo simulate the RE model we simply need to include $\\tau^2$ in the EE model simulation.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nk <- 15 # number of studies\nmu <- 0.5 # average effect\ntau2 <- 0.1 # heterogeneity\nn <- 10 + rpois(k, 30 - 10) # sample size\ndeltai <- rnorm(k, 0, sqrt(tau2)) # random-effects\nthetai <- mu + deltai # true study effect\n\ndat <- sim_studies(k = k, es = thetai, n1 = n)\n\nhead(dat)\n#> \n#>   id     yi     vi n1 n2 \n#> 1  1 0.7846 0.0619 28 28 \n#> 2  2 0.1172 0.0518 34 34 \n#> 3  3 0.2959 0.0448 36 36 \n#> 4  4 0.6724 0.0812 27 27 \n#> 5  5 0.5403 0.0754 30 30 \n#> 6  6 0.3871 0.1025 26 26\n```\n:::\n\n\n## Simulating a RE model\n\nAgain, we can put everything within a function expanding the previous `sim_studies()` by including $\\tau^2$:\n\n\n\n\n\n```r\nsim_studies <- function(k, es, tau2 = 0, n1, n2 = NULL, add = NULL){\n  if(length(n1) == 1) n1 <- rep(n1, k)\n  if(is.null(n2)) n2 <- n1\n  if(length(es) == 1) es <- rep(es, k)\n  \n  yi <- rep(NA, k)\n  vi <- rep(NA, k)\n  \n  # random effects\n  deltai <- rnorm(k, 0, sqrt(tau2))\n  \n  for(i in 1:k){\n    g1 <- rnorm(n1[i], 0, 1)\n    g2 <- rnorm(n2[i], es[i] + deltai[i], 1)\n    yi[i] <- mean(g2) - mean(g1)\n    vi[i] <- var(g1)/n1[i] + var(g2)/n2[i]\n  }\n  \n  sim <- data.frame(id = 1:k, yi, vi, n1 = n1, n2 = n2)\n  \n  if(!is.null(add)){\n    sim <- cbind(sim, add)\n  }\n  \n  # convert to escalc for using metafor methods\n  sim <- metafor::escalc(yi = yi, vi = vi, data = sim)\n  \n  return(sim)\n}\n```\n\n## Simulating a RE model\n\nThe data are similar to the EE simulation but we have an extra source of heterogeneity.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](meta-analysis-models_files/figure-revealjs/unnamed-chunk-21-1.svg){fig-align='center' width=960}\n:::\n:::\n\n\n## Simulating a RE model\n\nTo see the actual impact of $\\tau^2$ we can follow the same approach of @sec-ee-impact-n thus using a large $n$. The sampling variance `vi` of each study is basically 0.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# ... other parameters as before\nn <- 1e4\ndeltai <- rnorm(k, 0, sqrt(tau2)) # random-effects\nthetai <- mu + deltai # true study effect\ndat <- sim_studies(k = k, es = thetai, n1 = n)\n# or equivalently \n# dat <- sim_studies(k = k, es = mu, tau2 = tau2, n1 = n)\n\nhead(dat)\n#> \n#>   id     yi     vi    n1    n2 \n#> 1  1 0.5369 0.0002 10000 10000 \n#> 2  2 0.3332 0.0002 10000 10000 \n#> 3  3 0.7310 0.0002 10000 10000 \n#> 4  4 1.0248 0.0002 10000 10000 \n#> 5  5 0.3556 0.0002 10000 10000 \n#> 6  6 0.3460 0.0002 10000 10000\n```\n:::\n\n\n## Simulating a RE Model\n\nClearly, compared to @sec-ee-impact-n, even with large $n$ the variability is not reduced because $\\tau^2 \\neq 0$. As $\\tau^2$ approach zero the EE and RE models are similar.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](meta-analysis-models_files/figure-revealjs/unnamed-chunk-23-1.svg){fig-align='center' width=960}\n:::\n:::\n\n\n## RE model estimation\n\nGiven that we extended the EE model equation. Also the estimation of the average effect need to be extended. Basically the RE is still a weighted average but weights need to include also $\\tau^2$.\n\n$$\n\\overline y = \\frac{\\sum_{i = 1}^k y_iw^*_i}{\\sum_{i = 1}^k w^*_i}\n$$ {#eq-re1}\n\n$$\nw^*_i = \\frac{1}{\\sigma^2_i + \\tau^2}\n$$ {#eq-re2}\n\nThe weights are different compared to the EE model. Extremely precise/imprecise studies will have less impact in the RE model.\n\n## Fitting a RE model\n\nIn R we can use the `metafor::rma()` function using the `method = \"REML\"`.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfit <- rma(yi, vi, data = dat, method = \"REML\")\nsummary(fit)\n#> \n#> Random-Effects Model (k = 15; tau^2 estimator: REML)\n#> \n#>   logLik  deviance       AIC       BIC      AICc   \n#>  -1.5282    3.0563    7.0563    8.3344    8.1472   \n#> \n#> tau^2 (estimated amount of total heterogeneity): 0.0726 (SE = 0.0275)\n#> tau (square root of estimated tau^2 value):      0.2695\n#> I^2 (total heterogeneity / total variability):   99.73%\n#> H^2 (total variability / sampling variability):  366.42\n#> \n#> Test for Heterogeneity:\n#> Q(df = 14) = 5120.1182, p-val < .0001\n#> \n#> Model Results:\n#> \n#> estimate      se    zval    pval   ci.lb   ci.ub      \n#>   0.5547  0.0697  7.9602  <.0001  0.4181  0.6913  *** \n#> \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n\n## Intepreting the RE model\n\nThe model output is quite similar to the EE model and also the intepretation is similar.\n\nThe only extra section is `tau^2/tau` that is the estimation of the between-study heterogeneity.\n\n\n::: {.cell layout-align=\"center\"}\n\n```\n#> \n#> Random-Effects Model (k = 15; tau^2 estimator: REML)\n#> \n#>   logLik  deviance       AIC       BIC      AICc   \n#>  -1.5282    3.0563    7.0563    8.3344    8.1472   \n#> \n#> tau^2 (estimated amount of total heterogeneity): 0.0726 (SE = 0.0275)\n#> tau (square root of estimated tau^2 value):      0.2695\n#> I^2 (total heterogeneity / total variability):   99.73%\n#> H^2 (total variability / sampling variability):  366.42\n#> \n#> Test for Heterogeneity:\n#> Q(df = 14) = 5120.1182, p-val < .0001\n#> \n#> Model Results:\n#> \n#> estimate      se    zval    pval   ci.lb   ci.ub      \n#>   0.5547  0.0697  7.9602  <.0001  0.4181  0.6913  *** \n#> \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n\n\n## Estimating $\\tau^2$\n\n\n![](img/langan2017.png){fig-align=\"center\" width=80%}\n\n## Estimating $\\tau^2$\n\nThe **Restricted Maximum Likelihood** (REML) estimator is considered one of the best. We can compare the results using the `all_rma()` custom function that tests all the estimators^[The `filor::compare_rma()` function is similar to the `car::compareCoefs()` function].\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nfitl <- all_rma(fit)\nround(filor::compare_rma(fitlist = fitl), 3)\n#>           DL     HE     HS    HSk     SJ     ML   REML     EB     PM    PMM\n#> b      0.555  0.555  0.555  0.555  0.555  0.555  0.555  0.555  0.555  0.555\n#> se     0.070  0.070  0.067  0.070  0.070  0.067  0.070  0.070  0.070  0.071\n#> zval   7.968  7.960  8.247  7.968  7.961  8.240  7.960  7.960  7.961  7.771\n#> pval   0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000\n#> ci.lb  0.418  0.418  0.423  0.418  0.418  0.423  0.418  0.418  0.418  0.415\n#> ci.ub  0.691  0.691  0.686  0.691  0.691  0.687  0.691  0.691  0.691  0.695\n#> I2    99.727 99.727 99.707 99.727 99.727 99.708 99.727 99.727 99.727 99.740\n#> tau2   0.072  0.073  0.068  0.072  0.073  0.068  0.073  0.073  0.073  0.076\n```\n:::\n\n\n## Intepreting heterogeneity $\\tau^2$\n\nLooking at @eq-re-mod2, $\\tau^2$ is essentially the variance of the random-effect. This means that we can intepret it as the variability (or the standard deviation) of the true effect size distribution.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](meta-analysis-models_files/figure-revealjs/unnamed-chunk-27-1.svg){fig-align='center' width=960}\n:::\n:::\n\n\n## Intepreting $\\tau^2$\n\nAs in the previus plot we can assume $n = \\infty$ and generate true effects from @eq-re-mod2. In this way we understand the impact of assuming (or estimating) a certain $\\tau^2$.\n\nFor example, a $\\tau = 0.2$ and a $\\mu_{\\theta} = 0.5$, 50% of the true effects ranged between:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nD <- 0.5\nyis <- D + rnorm(1e5, 0, 0.2)\nquantile(yis, c(0.75, 0.25))\n#>       75%       25% \n#> 0.6355850 0.3642486\n```\n:::\n\n\n## The $Q$ Statistics^[See @Harrer2021-go (Chapter 5) and @Hedges2019-ry for an overview about the Q statistics]\n\nThe Q statistics is used to make inference on the heterogeneity. Can be considered as a weighted sum of squares:\n\n$$\nQ = \\sum^k_{i = 1}w_i(y_i - \\hat \\mu)^2\n$$\n\nWhere $\\hat \\mu$ is EE estimation (regardless if $\\tau^2 \\neq 0$) and $w_i$ are the inverse-variance weights. Note that in the case of $w_1 = w_2 ... = w_i$, Q is just a standard sum of squares (or deviance).\n\n## The $Q$ Statistics\n\n- Given that we are summing up squared distances, they should be approximately $\\chi^2$ with $df = k - 1$. In case of no heterogeneity ($\\tau^2 = 0$) the observed variability is only caused by sampling error and the expectd value of the $\\chi^2$ is just the degrees of freedom ($df = k - 1$).\n- In case of $\\tau^2 \\neq 0$, the expected value is $k - 1 + \\lambda$ where $\\lambda$ is a non-centrality parameter.\n- In other terms, if the expected value of $Q$ exceed the expected value assuming no heterogeneity, we have evidence that $\\tau^2 \\neq 0$.\n\n## The $Q$ Statistics\n\nLet's try a more practical approach. We simulate a lot of meta-analysis with and without heterogeneity and we check the Q statistics.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\nget_Q <- function(yi, vi){\n  wi <- 1/vi\n  theta_ee <- weighted.mean(yi, wi)\n  sum(wi*(yi - theta_ee)^2)\n}\n\nk <- 30\nn <- 30\ntau2 <- 0.1\nnsim <- 1e4\n\nQs_tau2_0 <- rep(0, nsim)\nQs_tau2 <- rep(0, nsim)\nres2_tau2_0 <- vector(\"list\", nsim)\nres2_tau2 <- vector(\"list\", nsim)\n\nfor(i in 1:nsim){\n  dat_tau2_0 <- sim_studies(k = 30, es = 0.5, tau2 = 0, n1 = n)\n  dat_tau2 <- sim_studies(k = 30, es = 0.5, tau2 = tau2, n1 = n)\n  \n  theta_ee_tau2_0 <- weighted.mean(dat_tau2_0$yi, 1/dat_tau2_0$vi)\n  theta_ee <- weighted.mean(dat_tau2$yi, 1/dat_tau2$vi)\n  \n  res2_tau2_0[[i]] <- dat_tau2_0$yi - theta_ee_tau2_0\n  res2_tau2[[i]] <- dat_tau2$yi - theta_ee\n  \n  Qs_tau2_0[i] <- get_Q(dat_tau2_0$yi, dat_tau2_0$vi)\n  Qs_tau2[i] <- get_Q(dat_tau2$yi, dat_tau2$vi)\n}\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](meta-analysis-models_files/figure-revealjs/unnamed-chunk-30-1.svg){fig-align='center' width=960}\n:::\n:::\n\n\n## The $Q$ Statistics\n\nLet's try a more practical approach. We simulate a lot of meta-analysis with and without heterogeneity and we check the Q statistics.\n\n. . .\n\n- clearly, in the presence of heterogeneity, the expected value of the Q statistics is higher (due to $\\lambda \\neq 0$) and also residuals are larger (the $\\chi^2$ is just a sum of squared weighted residuals)\n\n. . .\n\n- we can calculate a p-value for deviation from the $\\tau^2 = 0$ case as evidence agaist the absence of heterogeneity\n\n## $I^2$ [@Higgins2002-fh]\n\nWe have two sources of variability in a random-effects meta-analysis, the sampling variability $\\sigma_i^2$ and true heterogeneity $\\tau^2$. We can use the $I^2$ to express the interplay between the two.\n$$\nI^2 = 100\\% \\times \\frac{\\hat{\\tau}^2}{\\hat{\\tau}^2 + \\tilde{v}}\n$${#eq-i2}\n\n$$\n\\tilde{v} = \\frac{(k-1) \\sum w_i}{(\\sum w_i)^2 - \\sum w_i^2},\n$$\n\nWhere $\\tilde{v}$ is the typical sampling variability. $I^2$ is intepreted as the proportion of total variability due to real heterogeneity (i.e., $\\tau^2$)\n\n## $I^2$ [@Higgins2002-fh]^[see [https://www.meta-analysis-workshops.com/download/common-mistakes1.pdf](https://www.meta-analysis-workshops.com/download/common-mistakes1.pdf)]\n\nNote that we can have the same $I^2$ in two completely different meta-analysis. An high $I^2$ does not represent high heterogeneity. Let's assume to have two meta-analysis with $k$ studies and small ($n = 30$) vs large ($n = 500$) sample sizes. \n\nLet's solve @eq-i2 for $\\tau^2$ (using `filor::tau2_from_I2()`) and we found that the same $I^2$ can be obtained with two completely different $\\tau^2$ values:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nn_1 <- 30\nvi_1 <- 1/n_1 + 1/n_1\ntau2_1 <- filor::tau2_from_I2(0.8, vi_1)\ntau2_1\n#> [1] 0.2666667\n\nn_2 <- 500\nvi_2 <- 1/n_2 + 1/n_2\ntau2_2 <- filor::tau2_from_I2(0.8, vi_2)\ntau2_2\n#> [1] 0.016\n```\n:::\n\n\n## $I^2$ [@Higgins2002-fh]\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nn_1 <- 30\nvi_1 <- 1/n_1 + 1/n_1\ntau2_1 <- filor::tau2_from_I2(0.8, vi_1)\ntau2_1\n#> [1] 0.2666667\n\nn_2 <- 500\nvi_2 <- 1/n_2 + 1/n_2\ntau2_2 <- filor::tau2_from_I2(0.8, vi_2)\ntau2_2\n#> [1] 0.016\n```\n:::\n\n\n. . .\n\nIn other terms, the $I^2$ can be considered a good index of heterogeneity only when the total variance ($\\tilde{v} + \\tau^2$) is similar.\n\n## What about $\\tilde{v}$?\n\n$\\tilde{v}$ is considered the \"typical\" within-study variability (see [https://www.metafor-project.org/doku.php/tips:i2_multilevel_multivariate](https://www.metafor-project.org/doku.php/tips:i2_multilevel_multivariate)). There are different estimators but @eq-tildev [@Higgins2002-fh] is the most common.\n\n$$\n\\tilde{v} = \\frac{(k-1) \\sum w_i}{(\\sum w_i)^2 - \\sum w_i^2}\n$$ {#eq-tildev}\n\n## What about $\\tilde{v}$?\n\nIn the hypothetical case where $\\sigma^2_1 = \\dots = \\sigma^2_k$, $\\tilde{v}$ is just $\\sigma^2$. This fact is commonly used to calculate the statistical power analytically [@Borenstein2009-mo, Chapter 29].\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nvtilde <- function(wi){\n  k <- length(wi)\n  (k - 1) * sum(wi) / (sum(wi)^2 - sum(wi^2))\n}\n\nk <- 20\n\n# same vi\nvi <- rep((1/30 + 1/30), k)\nhead(vi)\n#> [1] 0.06666667 0.06666667 0.06666667 0.06666667 0.06666667 0.06666667\nvtilde(1/vi)\n#> [1] 0.06666667\n\n# heterogeneous vi\nn <- 10 + rpois(k, 30 - 10)\nvi <- sim_vi(k = k, n1 = n)\nvtilde(1/vi)\n#> [1] 0.06067894\n```\n:::\n\n\n## What about $\\tilde{v}$?\n\nUsing simulations we can see that $\\tilde{v}$ with heterogenenous variances (i.e., sample sizes in this case) can be approximated by the central tendency of the sample size distribution. Note that we are fixing $\\sigma^2 = 1$ thus we are not including uncertainty.\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](meta-analysis-models_files/figure-revealjs/unnamed-chunk-35-1.svg){fig-align='center' width=960}\n:::\n:::\n\n\n## $H^2$\n\nThe $H^2$ is an alternative index of heterogeneity. Is calculated as:\n\n$$\nH^2 = \\frac{Q}{k - 1}\n$$\n\nWe defined $Q$ as the weighted sum of squares representing the total variability. $k - 1$ is the expected value of the $\\chi^2$ statistics (i.e., sum of squares) when $\\tau^2 = 0$ (or $\\lambda = 0$). \n\nThus $H^2$ is the ratio between total heterogeneity and sampling variability. Higher $H^2$ is associated with higher heterogeneity **relative** to the sampling variability. $H^2$ is not a measure of absolute heterogeneity.\n\n## $H^2$\n\nWhen we are fitting a RE model, the $I^2$ and $H^2$ equations are slightly different [@Higgins2002-fh]. See also the `metafor` [source code](https://github.com/cran/metafor/blob/994d26a65455fac90760ad6a004ec1eaca5856b1/R/rma.uni.r#L2459C30-L2459C30).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nk <- 100\nmu <- 0.5\ntau2 <- 0.1\nn <- 30\n\ndat <- sim_studies(k = k, es = mu, tau2 = tau2, n1 = n)\nfit_re <- rma(yi, vi, data = dat, method = \"REML\")\nfit_ee <- rma(yi, vi, data = dat, method = \"EE\")\n\n# H2 with EE model\n\ntheta_ee <- fit_ee$b[[1]] # weighted.mean(dat$yi, 1/dat$vi)\nwi <- 1/dat$vi\nQ <- with(dat, sum((1/vi)*(yi - theta_ee)^2))\nc(Q, fit_ee$QE) # same\n#> [1] 279.0393 279.0393\n\nc(H2 = fit_ee$QE / (fit_ee$k - fit_ee$p), H2_model = fit_ee$H2) # same\n#>       H2 H2_model \n#> 2.818579 2.818579\n\n# H2 with RE model\n\nvt <- vtilde(1/dat$vi)\nc(H2 = fit_re$tau2 / vt + 1, H2_model = fit_re$H2) # same\n#>       H2 H2_model \n#> 2.797465 2.797465\n```\n:::\n\n\n## Confidence Intervals\n\nWhat is reported in the model summary as `ci.lb` and `ci.ub` refers to the 95% confidence interval representing the uncertainty in estimating the effect (or a meta-regression parameter).\n\nWithout looking at the equations, let's try to implement this idea using simulations.\n\n- choose $k$, $\\tau^2$ and $n$\n- simulate data (several times) accordingly and fit the RE model\n- extract the estimated effect size\n- compare the simulated sampling distribution with the analytical result\n\n## Confidence Intervals\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nk <- 30\nn <- 30\ntau2 <- 0.05\nmu <- 0.5\nnsim <- 5e3\n\n# true parameters (see Borenstein, 2009; Chapter 29)\nvt <- 1/n + 1/n\nvs <- (vt + tau2)/ k\nse <- sqrt(vs)\n\nmui <- rep(NA, nsim)\n\nfor(i in 1:nsim){\n  dat <- sim_studies(k = k, es = mu, tau2 = tau2, n1 = n)\n  fit <- rma(yi, vi, data = dat)\n  mui[i] <- coef(fit)[1]\n}\n\n# standard error\nc(simulated = sd(mui), analytical = fit$se)\n#>  simulated analytical \n#> 0.06239326 0.06287405\n\n# confidence interval\nrbind(\n  \"simulated\"  = quantile(mui, c(0.05, 0.975)),\n  \"analytical\" = c(\"2.5%\" = fit$ci.lb, \"97.5%\" = fit$ci.ub)\n)\n#>                   5%     97.5%\n#> simulated  0.3972089 0.6222421\n#> analytical 0.3034138 0.5498756\n```\n:::\n\n\n## Confidence Intervals\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](meta-analysis-models_files/figure-revealjs/unnamed-chunk-38-1.svg){fig-align='center' width=960}\n:::\n:::\n\n\n## Confidence Intervals\n\nNow the equation for the 95% confidence interval should be more clear. The standard error is a function of the within study sampling variances (depending mainly on $n$), $\\tau^2$ and $k$. As we increase $k$ the standard error tends towards zero. \n\n$$\nCI = \\hat \\mu_{\\theta} \\pm z SE_{\\mu_{\\theta}}\n$$\n\n$$\nSE_{\\mu_{\\theta}} = \\sqrt{\\frac{1}{\\sum^{k}_{i = 1}w^{\\star}_i}}\n$$\n\n$$\nw^{\\star}_i = \\frac{1}{\\sigma^2_i + \\tau^2}\n$$\n\n## Confidence Intervals\n\nWe can also see it analytically, there is a huge impact of $k$.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](meta-analysis-models_files/figure-revealjs/unnamed-chunk-39-1.svg){fig-align='center' width=960}\n:::\n:::\n\n\n## Prediction intervals (PI)\n\nWe could say that the CI is not completely taking into account the between-study heterogeneity ($\\tau^2$). After a meta-analysis we would like to know how confident we are in the parameters estimation BUT also **what would be the expected effect running a new experiment tomorrow?**.\n\nThe **prediction interval** [@IntHout2016-sz; @Riley2011-hp] is exactly the range of effects that I expect in predicting a new study.\n\n## PI for a sample mean\n\nTo understand the concept, let's assume to have a sample $X$ of size $n$ and we estimate the mean $\\overline X$. The PI is calculated as^[Notice that the equation, in particular the usage of $t$ vs $z$ depends on assuming $s_x$ to be known or estimated. See [https://online.stat.psu.edu/stat501/lesson/3/3.3](https://online.stat.psu.edu/stat501/lesson/3/3.3), [https://en.wikipedia.org/wiki/Prediction_interval](https://en.wikipedia.org/wiki/Prediction_interval) and [https://www.bryanshalloway.com/2021/03/18/intuition-on-uncertainty-of-predictions-introduction-to-prediction-intervals/](https://www.bryanshalloway.com/2021/03/18/intuition-on-uncertainty-of-predictions-introduction-to-prediction-intervals/)]:\n\n$$\nPI = \\overline X \\pm t_{\\alpha/2} s_x \\sqrt{1 + \\frac{1}{n}}\n$$\n\nWhere $s$ is the sample standard deviation. Basically we are combining the uncertainty in estimating $\\overline X$ (i.e, $\\frac{s_x}{n}$) with the standard deviation of the data $s_x$. Compare it with the confidence interval containing only $\\frac{s_x}{n}$.\n\n## PI in meta-analysis\n\nFor meta-analysis the equation^[When a $t$ distribution is assumed, the quantiles are calculated using $k - 2$ degrees of freedom] is conceptually similar but with different quantities.\n\n$$\nPI = \\hat \\mu_{\\theta} \\pm z \\sqrt{\\tau^2 + SE_{\\mu_{\\theta}}}\n$$\n\nBasically we are combining all the sources of uncertainty. As long as $\\tau^2 \\neq 0$ the PI is greater than the CI (in the EE model they are the same). Thus even with very precise $\\mu_{\\theta}$ estimation, large $\\tau^2$ leads to uncertain predictions.\n\n## PI in meta-analysis\n\nIn R the PI can be calculated using `predict()`. By default the model assume a standard normal distribution thus using $z$ scores. To use the @Riley2011-hp approach ($t$ distribution) the model need to be fitted using `test = \"t\"`.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nk <- 100\ndat <- sim_studies(k = k, es = 0.5, tau2 = 0.1, n1 = 30)\nfit_z <- rma(yi, vi, data = dat, test = \"z\") # test = \"z\" is the default\npredict(fit_z) # notice pi.ub/pi.lb vs ci.ub/ci.lb\n#> \n#>    pred     se  ci.lb  ci.ub  pi.lb  pi.ub \n#>  0.4927 0.0351 0.4239 0.5615 0.0137 0.9717\n# manually\nfit_z$b[[1]] + qnorm(c(0.025, 0.975)) * sqrt(fit_z$se^2 + fit_z$tau2)\n#> [1] 0.01365251 0.97168920\n\nfit_t <- rma(yi, vi, data = dat, test = \"t\")\npredict(fit_t) # notice pi.ub/pi.lb vs ci.ub/ci.lb\n#> \n#>    pred     se  ci.lb  ci.ub  pi.lb  pi.ub \n#>  0.4927 0.0351 0.4230 0.5623 0.0077 0.9776\n# manually\nfit_z$b[[1]] + qt(c(0.025, 0.975), k - 2) * sqrt(fit_t$se^2 + fit_t$tau2)\n#> [1] 0.007663823 0.977677890\n```\n:::\n\n\n## References <button class=\"btn\"><i class=\"fa fa-download\"></i><a href=\"data:text/x-bibtex;base64,QE1JU0N7Qm9yZW5zdGVpbjIwMDktbW8sCiAgdGl0bGUgPSB7SW50cm9kdWN0aW9uIHRvIHtNZXRhLUFuYWx5c2lzfX0sCiAgYXV0aG9yID0ge0JvcmVuc3RlaW4sIE1pY2hhZWwgYW5kIEhlZGdlcywgTGFycnkgViBhbmQgSGlnZ2lucywgSnVsaWFuIFAgVCBhbmQKICBSb3Roc3RlaW4sIEhhbm5haCBSfSwKICBkYXRlID0gezIwMDl9LAogIGRvaSA9IHsxMC4xMDAyLzk3ODA0NzA3NDMzODZ9LAogIHVybCA9IHtodHRwOi8vZHguZG9pLm9yZy8xMC4xMDAyLzk3ODA0NzA3NDMzODZ9LAogIGtleXdvcmRzID0ge01BIFVuY29uc2Npb3VzIFdNfQp9CgpAQVJUSUNMRXtIaWdnaW5zMjAwMi1maCwKICB0aXRsZSA9IHtRdWFudGlmeWluZyBoZXRlcm9nZW5laXR5IGluIGEgbWV0YS1hbmFseXNpc30sCiAgYXV0aG9yID0ge0hpZ2dpbnMsIEp1bGlhbiBQIFQgYW5kIFRob21wc29uLCBTaW1vbiBHfSwKICBqb3VybmFsdGl0bGUgPSB7U3RhdGlzdGljcyBpbiBtZWRpY2luZX0sCiAgdm9sdW1lID0gezIxfSwKICBpc3N1ZSA9IHsxMX0sCiAgcGFnZXMgPSB7MTUzOS0xNTU4fSwKICBkYXRlID0gezIwMDItMDYtMTV9LAogIGRvaSA9IHsxMC4xMDAyL3NpbS4xMTg2fSwKICBwbWlkID0gezEyMTExOTE5fSwKICBpc3NuID0gezAyNzctNjcxNX0sCiAgYWJzdHJhY3QgPSB7VGhlIGV4dGVudCBvZiBoZXRlcm9nZW5laXR5IGluIGEgbWV0YS1hbmFseXNpcyBwYXJ0bHkgZGV0ZXJtaW5lcwogIHRoZSBkaWZmaWN1bHR5IGluIGRyYXdpbmcgb3ZlcmFsbCBjb25jbHVzaW9ucy4gVGhpcyBleHRlbnQgbWF5IGJlIG1lYXN1cmVkIGJ5CiAgZXN0aW1hdGluZyBhIGJldHdlZW4tc3R1ZHkgdmFyaWFuY2UsIGJ1dCBpbnRlcnByZXRhdGlvbiBpcyB0aGVuIHNwZWNpZmljIHRvIGEKICBwYXJ0aWN1bGFyIHRyZWF0bWVudCBlZmZlY3QgbWV0cmljLiBBIHRlc3QgZm9yIHRoZSBleGlzdGVuY2Ugb2YgaGV0ZXJvZ2VuZWl0eQogIGV4aXN0cywgYnV0IGRlcGVuZHMgb24gdGhlIG51bWJlciBvZiBzdHVkaWVzIGluIHRoZSBtZXRhLWFuYWx5c2lzLiBXZSBkZXZlbG9wCiAgbWVhc3VyZXMgb2YgdGhlIGltcGFjdCBvZiBoZXRlcm9nZW5laXR5IG9uIGEgbWV0YS1hbmFseXNpcywgZnJvbSBtYXRoZW1hdGljYWwKICBjcml0ZXJpYSwgdGhhdCBhcmUgaW5kZXBlbmRlbnQgb2YgdGhlIG51bWJlciBvZiBzdHVkaWVzIGFuZCB0aGUgdHJlYXRtZW50CiAgZWZmZWN0IG1ldHJpYy4gV2UgZGVyaXZlIGFuZCBwcm9wb3NlIHRocmVlIHN1aXRhYmxlIHN0YXRpc3RpY3M6IEggaXMgdGhlCiAgc3F1YXJlIHJvb3Qgb2YgdGhlIGNoaTIgaGV0ZXJvZ2VuZWl0eSBzdGF0aXN0aWMgZGl2aWRlZCBieSBpdHMgZGVncmVlcyBvZgogIGZyZWVkb207IFIgaXMgdGhlIHJhdGlvIG9mIHRoZSBzdGFuZGFyZCBlcnJvciBvZiB0aGUgdW5kZXJseWluZyBtZWFuIGZyb20gYQogIHJhbmRvbSBlZmZlY3RzIG1ldGEtYW5hbHlzaXMgdG8gdGhlIHN0YW5kYXJkIGVycm9yIG9mIGEgZml4ZWQgZWZmZWN0CiAgbWV0YS1hbmFseXRpYyBlc3RpbWF0ZSwgYW5kIEkyIGlzIGEgdHJhbnNmb3JtYXRpb24gb2YgKEgpIHRoYXQgZGVzY3JpYmVzIHRoZQogIHByb3BvcnRpb24gb2YgdG90YWwgdmFyaWF0aW9uIGluIHN0dWR5IGVzdGltYXRlcyB0aGF0IGlzIGR1ZSB0byBoZXRlcm9nZW5laXR5LgogIFdlIGRpc2N1c3MgaW50ZXJwcmV0YXRpb24sIGludGVydmFsIGVzdGltYXRlcyBhbmQgb3RoZXIgcHJvcGVydGllcyBvZiB0aGVzZQogIG1lYXN1cmVzIGFuZCBleGFtaW5lIHRoZW0gaW4gZml2ZSBleGFtcGxlIGRhdGEgc2V0cyBzaG93aW5nIGRpZmZlcmVudCBhbW91bnRzCiAgb2YgaGV0ZXJvZ2VuZWl0eS4gV2UgY29uY2x1ZGUgdGhhdCBIIGFuZCBJMiwgd2hpY2ggY2FuIHVzdWFsbHkgYmUgY2FsY3VsYXRlZAogIGZvciBwdWJsaXNoZWQgbWV0YS1hbmFseXNlcywgYXJlIHBhcnRpY3VsYXJseSB1c2VmdWwgc3VtbWFyaWVzIG9mIHRoZSBpbXBhY3QKICBvZiBoZXRlcm9nZW5laXR5LiBPbmUgb3IgYm90aCBzaG91bGQgYmUgcHJlc2VudGVkIGluIHB1Ymxpc2hlZCBtZXRhLWFuYWx5c2VzCiAgaW4gcHJlZmVyZW5jZSB0byB0aGUgdGVzdCBmb3IgaGV0ZXJvZ2VuZWl0eS59LAogIHVybCA9IHtodHRwOi8vZHguZG9pLm9yZy8xMC4xMDAyL3NpbS4xMTg2fSwKICBsYW5ndWFnZSA9IHtlbn0KfQoKQEFSVElDTEV7SGVkZ2VzMjAxOS1yeSwKICB0aXRsZSA9IHtTdGF0aXN0aWNhbCBhbmFseXNlcyBmb3Igc3R1ZHlpbmcgcmVwbGljYXRpb246IE1ldGEtYW5hbHl0aWMKICBwZXJzcGVjdGl2ZXN9LAogIGF1dGhvciA9IHtIZWRnZXMsIExhcnJ5IFYgYW5kIFNjaGF1ZXIsIEphY29iIE19LAogIGpvdXJuYWx0aXRsZSA9IHtQc3ljaG9sb2dpY2FsIG1ldGhvZHN9LAogIHB1Ymxpc2hlciA9IHtBbWVyaWNhbiBQc3ljaG9sb2dpY2FsIEFzc29jaWF0aW9uIChBUEEpfSwKICB2b2x1bWUgPSB7MjR9LAogIGlzc3VlID0gezV9LAogIHBhZ2VzID0gezU1Ny01NzB9LAogIGRhdGUgPSB7MjAxOS0xMH0sCiAgZG9pID0gezEwLjEwMzcvbWV0MDAwMDE4OX0sCiAgcG1pZCA9IHszMDA3MDU0N30sCiAgaXNzbiA9IHsxMDgyLTk4OVgsMTkzOS0xNDYzfSwKICBhYnN0cmFjdCA9IHtGb3JtYWwgZW1waXJpY2FsIGFzc2Vzc21lbnRzIG9mIHJlcGxpY2F0aW9uIGhhdmUgcmVjZW50bHkgYmVjb21lCiAgbW9yZSBwcm9taW5lbnQgaW4gc2V2ZXJhbCBhcmVhcyBvZiBzY2llbmNlLCBpbmNsdWRpbmcgcHN5Y2hvbG9neS4gVGhlc2UKICBhc3Nlc3NtZW50cyBoYXZlIHVzZWQgZGlmZmVyZW50IHN0YXRpc3RpY2FsIGFwcHJvYWNoZXMgdG8gZGV0ZXJtaW5lIGlmIGEKICBmaW5kaW5nIGhhcyBiZWVuIHJlcGxpY2F0ZWQuIFRoZSBwdXJwb3NlIG9mIHRoaXMgYXJ0aWNsZSBpcyB0byBwcm92aWRlIHNldmVyYWwKICBhbHRlcm5hdGl2ZSBjb25jZXB0dWFsIGZyYW1ld29ya3MgdGhhdCBsZWFkIHRvIGRpZmZlcmVudCBzdGF0aXN0aWNhbCBhbmFseXNlcwogIHRvIHRlc3QgaHlwb3RoZXNlcyBhYm91dCByZXBsaWNhdGlvbi4gQWxsIG9mIHRoZXNlIGFuYWx5c2VzIGFyZSBiYXNlZCBvbgogIHN0YXRpc3RpY2FsIG1ldGhvZHMgdXNlZCBpbiBtZXRhLWFuYWx5c2lzLiBUaGUgZGlmZmVyZW5jZXMgYW1vbmcgdGhlIG1ldGhvZHMKICBkZXNjcmliZWQgaW52b2x2ZSB3aGV0aGVyIHRoZSBidXJkZW4gb2YgcHJvb2YgaXMgcGxhY2VkIG9uIHJlcGxpY2F0aW9uIG9yCiAgbm9ucmVwbGljYXRpb24sIHdoZXRoZXIgcmVwbGljYXRpb24gaXMgZXhhY3Qgb3IgYWxsb3dzIGZvciBhIHNtYWxsIGFtb3VudCBvZgogICJuZWdsaWdpYmxlIGhldGVyb2dlbmVpdHksIiBhbmQgd2hldGhlciB0aGUgc3R1ZGllcyBvYnNlcnZlZCBhcmUgYXNzdW1lZCB0byBiZQogIGZpeGVkIChjb25zdGl0dXRpbmcgdGhlIGVudGlyZSBib2R5IG9mIHJlbGV2YW50IGV2aWRlbmNlKSBvciBhcmUgYSBzYW1wbGUgZnJvbQogIGEgdW5pdmVyc2Ugb2YgcG9zc2libHkgcmVsZXZhbnQgc3R1ZGllcy4gVGhlIHN0YXRpc3RpY2FsIHBvd2VyIG9mIGVhY2ggb2YKICB0aGVzZSB0ZXN0cyBpcyBjb21wdXRlZCBhbmQgc2hvd24gdG8gYmUgbG93IGluIG1hbnkgY2FzZXMsIHJhaXNpbmcgaXNzdWVzIG9mCiAgdGhlIGludGVycHJldGFiaWxpdHkgb2YgdGVzdHMgZm9yIHJlcGxpY2F0aW9uLiAoUHN5Y0lORk8gRGF0YWJhc2UgUmVjb3JkIChjKQogIDIwMTkgQVBBLCBhbGwgcmlnaHRzIHJlc2VydmVkKS59LAogIHVybCA9IHtodHRwOi8vZHguZG9pLm9yZy8xMC4xMDM3L21ldDAwMDAxODl9LAogIGZpbGUgPSB7SGVkZ2VzIGFuZCBTY2hhdWVyIDIwMTkgLSBTdGF0aXN0aWNhbCBhbmFseXNlcyBmb3Igc3R1ZHlpbmcgcmVwbGljYXRpb24gLSBNZXRhLWFuYWx5dGljIHBlcnNwZWN0aXZlcy5wZGZ9LAogIGtleXdvcmRzID0ge3JlcGxpY2F0aW9uLW1ldGhvZHN9LAogIGxhbmd1YWdlID0ge2VufQp9CgpAQVJUSUNMRXtSaWxleTIwMTEtaHAsCiAgdGl0bGUgPSB7SW50ZXJwcmV0YXRpb24gb2YgcmFuZG9tIGVmZmVjdHMgbWV0YS1hbmFseXNlc30sCiAgYXV0aG9yID0ge1JpbGV5LCBSaWNoYXJkIEQgYW5kIEhpZ2dpbnMsIEp1bGlhbiBQIFQgYW5kIERlZWtzLCBKb25hdGhhbiBKfSwKICBqb3VybmFsdGl0bGUgPSB7Qk1KfSwKICB2b2x1bWUgPSB7MzQyfSwKICBwYWdlcyA9IHtkNTQ5fSwKICBkYXRlID0gezIwMTEtMDItMTB9LAogIGRvaSA9IHsxMC4xMTM2L2Jtai5kNTQ5fSwKICBwbWlkID0gezIxMzEwNzk0fSwKICBpc3NuID0gezA5NTktODEzOCwxNzU2LTE4MzN9LAogIHVybCA9IHtodHRwOi8vZHguZG9pLm9yZy8xMC4xMTM2L2Jtai5kNTQ5fSwKICBrZXl3b3JkcyA9IHtNQSBVbmNvbnNjaW91cyBXTX0sCiAgbGFuZ3VhZ2UgPSB7ZW59Cn0KCkBBUlRJQ0xFe0ludEhvdXQyMDE2LXN6LAogIHRpdGxlID0ge1BsZWEgZm9yIHJvdXRpbmVseSBwcmVzZW50aW5nIHByZWRpY3Rpb24gaW50ZXJ2YWxzIGluIG1ldGEtYW5hbHlzaXN9LAogIGF1dGhvciA9IHtJbnRIb3V0LCBKb2FubmEgYW5kIElvYW5uaWRpcywgSm9obiBQIEEgYW5kIFJvdmVycywgTWFyb2Vza2EgTSBhbmQKICBHb2VtYW4sIEplbGxlIEp9LAogIGpvdXJuYWx0aXRsZSA9IHtCTUogb3Blbn0sCiAgdm9sdW1lID0gezZ9LAogIGlzc3VlID0gezd9LAogIHBhZ2VzID0ge2UwMTAyNDd9LAogIGRhdGUgPSB7MjAxNi0wNy0xMn0sCiAgZG9pID0gezEwLjExMzYvYm1qb3Blbi0yMDE1LTAxMDI0N30sCiAgcG1jID0ge1BNQzQ5NDc3NTF9LAogIHBtaWQgPSB7Mjc0MDY2Mzd9LAogIGlzc24gPSB7MjA0NC02MDU1fSwKICBhYnN0cmFjdCA9IHtPQkpFQ1RJVkVTOiBFdmFsdWF0aW5nIHRoZSB2YXJpYXRpb24gaW4gdGhlIHN0cmVuZ3RoIG9mIHRoZSBlZmZlY3QKICBhY3Jvc3Mgc3R1ZGllcyBpcyBhIGtleSBmZWF0dXJlIG9mIG1ldGEtYW5hbHlzZXMuIFRoaXMgdmFyaWFiaWxpdHkgaXMKICByZWZsZWN0ZWQgYnkgbWVhc3VyZXMgbGlrZSDPhCgyKSBvciBJKDIpLCBidXQgdGhlaXIgY2xpbmljYWwgaW50ZXJwcmV0YXRpb24gaXMKICBub3Qgc3RyYWlnaHRmb3J3YXJkLiBBIHByZWRpY3Rpb24gaW50ZXJ2YWwgaXMgbGVzcyBjb21wbGljYXRlZDogaXQgcHJlc2VudHMKICB0aGUgZXhwZWN0ZWQgcmFuZ2Ugb2YgdHJ1ZSBlZmZlY3RzIGluIHNpbWlsYXIgc3R1ZGllcy4gV2UgYWltZWQgdG8gc2hvdyB0aGUKICBhZHZhbnRhZ2VzIG9mIGhhdmluZyB0aGUgcHJlZGljdGlvbiBpbnRlcnZhbCByb3V0aW5lbHkgcmVwb3J0ZWQgaW4KICBtZXRhLWFuYWx5c2VzLiBERVNJR046IFdlIHNob3cgaG93IHRoZSBwcmVkaWN0aW9uIGludGVydmFsIGNhbiBoZWxwIHVuZGVyc3RhbmQKICB0aGUgdW5jZXJ0YWludHkgYWJvdXQgd2hldGhlciBhbiBpbnRlcnZlbnRpb24gd29ya3Mgb3Igbm90LiBUbyBldmFsdWF0ZSB0aGUKICBpbXBsaWNhdGlvbnMgb2YgdXNpbmcgdGhpcyBpbnRlcnZhbCB0byBpbnRlcnByZXQgdGhlIHJlc3VsdHMsIHdlIHNlbGVjdGVkIHRoZQogIGZpcnN0IG1ldGEtYW5hbHlzaXMgcGVyIGludGVydmVudGlvbiByZXZpZXcgb2YgdGhlIENvY2hyYW5lIERhdGFiYXNlIG9mCiAgU3lzdGVtYXRpYyBSZXZpZXdzIElzc3VlcyAyMDA5LTIwMTMgd2l0aCBhIGRpY2hvdG9tb3VzIChuPTIwMDkpIG9yIGNvbnRpbnVvdXMKICAobj0xMjU0KSBvdXRjb21lLCBhbmQgZ2VuZXJhdGVkIDk1XCUgcHJlZGljdGlvbiBpbnRlcnZhbHMgZm9yIHRoZW0uIFJFU1VMVFM6CiAgSW4gNzIuNFwlIG9mIDQ3OSBzdGF0aXN0aWNhbGx5IHNpZ25pZmljYW50IChyYW5kb20tZWZmZWN0cyBwMCksIHRoZSA5NVwlCiAgcHJlZGljdGlvbiBpbnRlcnZhbCBzdWdnZXN0ZWQgdGhhdCB0aGUgaW50ZXJ2ZW50aW9uIGVmZmVjdCBjb3VsZCBiZSBudWxsIG9yCiAgZXZlbiBiZSBpbiB0aGUgb3Bwb3NpdGUgZGlyZWN0aW9uLiBJbiAyMC4zXCUgb2YgdGhvc2UgNDc5IG1ldGEtYW5hbHlzZXMsIHRoZQogIHByZWRpY3Rpb24gaW50ZXJ2YWwgc2hvd2VkIHRoYXQgdGhlIGVmZmVjdCBjb3VsZCBiZSBjb21wbGV0ZWx5IG9wcG9zaXRlIHRvIHRoZQogIHBvaW50IGVzdGltYXRlIG9mIHRoZSBtZXRhLWFuYWx5c2lzLiBXZSBkZW1vbnN0cmF0ZSBhbHNvIGhvdyB0aGUgcHJlZGljdGlvbgogIGludGVydmFsIGNhbiBiZSB1c2VkIHRvIGNhbGN1bGF0ZSB0aGUgcHJvYmFiaWxpdHkgdGhhdCBhIG5ldyB0cmlhbCB3aWxsIHNob3cgYQogIG5lZ2F0aXZlIGVmZmVjdCBhbmQgdG8gaW1wcm92ZSB0aGUgY2FsY3VsYXRpb25zIG9mIHRoZSBwb3dlciBvZiBhIG5ldyB0cmlhbC4KICBDT05DTFVTSU9OUzogVGhlIHByZWRpY3Rpb24gaW50ZXJ2YWwgcmVmbGVjdHMgdGhlIHZhcmlhdGlvbiBpbiB0cmVhdG1lbnQKICBlZmZlY3RzIG92ZXIgZGlmZmVyZW50IHNldHRpbmdzLCBpbmNsdWRpbmcgd2hhdCBlZmZlY3QgaXMgdG8gYmUgZXhwZWN0ZWQgaW4KICBmdXR1cmUgcGF0aWVudHMsIHN1Y2ggYXMgdGhlIHBhdGllbnRzIHRoYXQgYSBjbGluaWNpYW4gaXMgaW50ZXJlc3RlZCB0byB0cmVhdC4KICBQcmVkaWN0aW9uIGludGVydmFscyBzaG91bGQgYmUgcm91dGluZWx5IHJlcG9ydGVkIHRvIGFsbG93IG1vcmUgaW5mb3JtYXRpdmUKICBpbmZlcmVuY2VzIGluIG1ldGEtYW5hbHlzZXMufSwKICB1cmwgPSB7aHR0cDovL2R4LmRvaS5vcmcvMTAuMTEzNi9ibWpvcGVuLTIwMTUtMDEwMjQ3fSwKICBrZXl3b3JkcyA9IHtDbGluaWNhbCB0cmlhbDsgQ29jaHJhbmUgRGF0YWJhc2Ugb2YgU3lzdGVtYXRpYyBSZXZpZXdzOwogIEhldGVyb2dlbmVpdHk7IE1ldGEtYW5hbHlzaXM7IFByZWRpY3Rpb24gaW50ZXJ2YWw7IFJhbmRvbSBlZmZlY3RzO01BCiAgVW5jb25zY2lvdXMgV007QmF5ZXNpYW4gU3RhdGlzdGljc30sCiAgbGFuZ3VhZ2UgPSB7ZW59Cn0KCkBCT09Le0hhcnJlcjIwMjEtZ28sCiAgdGl0bGUgPSB7RG9pbmcgbWV0YS1hbmFseXNpcyB3aXRoIFI6IEEgaGFuZHMtb24gZ3VpZGV9LAogIGF1dGhvciA9IHtIYXJyZXIsIE1hdGhpYXMgYW5kIEN1aWpwZXJzLCBQaW0gYW5kIEZ1cnVrYXdhLCBUb3NoaSBhbmQgRWJlcnQsCiAgRGF2aWR9LAogIHB1Ymxpc2hlciA9IHtDUkMgUHJlc3N9LAogIGxvY2F0aW9uID0ge0xvbmRvbiwgRW5nbGFuZH0sCiAgZWRpdGlvbiA9IHsxc3R9LAogIGRhdGUgPSB7MjAyMS0wOS0xM30sCiAgcGFnZXRvdGFsID0gezQ3NH0sCiAgaXNibiA9IHs5NzgwMzY3NjEwMDc0fSwKICBsYW5ndWFnZSA9IHtlbn0KfQoK\" download=\"refs_to_download.bib\"> Download .bib file</a></button> {.refs}\n\n::: {#refs}\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}